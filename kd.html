<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>kd package &mdash; MIKA 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js?v=af2ce170"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=4825356b"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="ir package" href="ir.html" />
    <link rel="prev" title="utils package" href="utils.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            MIKA
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="readme.html">Overview</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="components.html">MIKA</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="utils.html">utils package</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">kd package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#mika-kd-fmea">mika.kd.FMEA</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mika.kd.FMEA"><code class="docutils literal notranslate"><span class="pre">FMEA</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#mika-kd-topic-model-plus">mika.kd.Topic_Model_plus</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mika.kd.Topic_Model_plus"><code class="docutils literal notranslate"><span class="pre">Topic_Model_plus</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-mika.kd.NER">mika.kd.NER</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mika.kd.NER.align_labels_with_tokens"><code class="docutils literal notranslate"><span class="pre">align_labels_with_tokens()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mika.kd.NER.build_confusion_matrix"><code class="docutils literal notranslate"><span class="pre">build_confusion_matrix()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mika.kd.NER.check_doc_to_sentence_split"><code class="docutils literal notranslate"><span class="pre">check_doc_to_sentence_split()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mika.kd.NER.clean_annots_from_str"><code class="docutils literal notranslate"><span class="pre">clean_annots_from_str()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mika.kd.NER.clean_doccano_annots"><code class="docutils literal notranslate"><span class="pre">clean_doccano_annots()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mika.kd.NER.clean_text_tags"><code class="docutils literal notranslate"><span class="pre">clean_text_tags()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mika.kd.NER.compute_classification_report"><code class="docutils literal notranslate"><span class="pre">compute_classification_report()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mika.kd.NER.compute_metrics"><code class="docutils literal notranslate"><span class="pre">compute_metrics()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mika.kd.NER.get_cleaned_label"><code class="docutils literal notranslate"><span class="pre">get_cleaned_label()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mika.kd.NER.identify_bad_annotations"><code class="docutils literal notranslate"><span class="pre">identify_bad_annotations()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mika.kd.NER.plot_eval_metrics"><code class="docutils literal notranslate"><span class="pre">plot_eval_metrics()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mika.kd.NER.plot_eval_results"><code class="docutils literal notranslate"><span class="pre">plot_eval_results()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mika.kd.NER.plot_loss"><code class="docutils literal notranslate"><span class="pre">plot_loss()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mika.kd.NER.read_doccano_annots"><code class="docutils literal notranslate"><span class="pre">read_doccano_annots()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mika.kd.NER.read_trainer_logs"><code class="docutils literal notranslate"><span class="pre">read_trainer_logs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mika.kd.NER.split_docs_to_sentences"><code class="docutils literal notranslate"><span class="pre">split_docs_to_sentences()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mika.kd.NER.tokenize"><code class="docutils literal notranslate"><span class="pre">tokenize()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mika.kd.NER.tokenize_and_align_labels"><code class="docutils literal notranslate"><span class="pre">tokenize_and_align_labels()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-mika.kd.trend_analysis">mika.kd.trend_analysis</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mika.kd.trend_analysis.add_hazards_to_docs"><code class="docutils literal notranslate"><span class="pre">add_hazards_to_docs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mika.kd.trend_analysis.bootstrap_metric"><code class="docutils literal notranslate"><span class="pre">bootstrap_metric()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mika.kd.trend_analysis.build_word_clouds"><code class="docutils literal notranslate"><span class="pre">build_word_clouds()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mika.kd.trend_analysis.calc_CI"><code class="docutils literal notranslate"><span class="pre">calc_CI()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mika.kd.trend_analysis.calc_classification_metrics"><code class="docutils literal notranslate"><span class="pre">calc_classification_metrics()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mika.kd.trend_analysis.calc_rate"><code class="docutils literal notranslate"><span class="pre">calc_rate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mika.kd.trend_analysis.calc_severity_per_hazard"><code class="docutils literal notranslate"><span class="pre">calc_severity_per_hazard()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mika.kd.trend_analysis.check_for_hazard_words"><code class="docutils literal notranslate"><span class="pre">check_for_hazard_words()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mika.kd.trend_analysis.check_for_negation_words"><code class="docutils literal notranslate"><span class="pre">check_for_negation_words()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mika.kd.trend_analysis.chi_squared_tests"><code class="docutils literal notranslate"><span class="pre">chi_squared_tests()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mika.kd.trend_analysis.corr_sig"><code class="docutils literal notranslate"><span class="pre">corr_sig()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mika.kd.trend_analysis.create_correlation_matrix"><code class="docutils literal notranslate"><span class="pre">create_correlation_matrix()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mika.kd.trend_analysis.examine_hazard_extraction_mismatches"><code class="docutils literal notranslate"><span class="pre">examine_hazard_extraction_mismatches()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mika.kd.trend_analysis.get_doc_text"><code class="docutils literal notranslate"><span class="pre">get_doc_text()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mika.kd.trend_analysis.get_doc_time"><code class="docutils literal notranslate"><span class="pre">get_doc_time()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mika.kd.trend_analysis.get_hazard_df"><code class="docutils literal notranslate"><span class="pre">get_hazard_df()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mika.kd.trend_analysis.get_hazard_doc_ids"><code class="docutils literal notranslate"><span class="pre">get_hazard_doc_ids()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mika.kd.trend_analysis.get_hazard_info"><code class="docutils literal notranslate"><span class="pre">get_hazard_info()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mika.kd.trend_analysis.get_hazard_topics"><code class="docutils literal notranslate"><span class="pre">get_hazard_topics()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mika.kd.trend_analysis.get_hazard_topics_per_doc"><code class="docutils literal notranslate"><span class="pre">get_hazard_topics_per_doc()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mika.kd.trend_analysis.get_hazard_words"><code class="docutils literal notranslate"><span class="pre">get_hazard_words()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mika.kd.trend_analysis.get_likelihood_FAA"><code class="docutils literal notranslate"><span class="pre">get_likelihood_FAA()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mika.kd.trend_analysis.get_likelihood_USFS"><code class="docutils literal notranslate"><span class="pre">get_likelihood_USFS()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mika.kd.trend_analysis.get_negation_words"><code class="docutils literal notranslate"><span class="pre">get_negation_words()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mika.kd.trend_analysis.get_results_info"><code class="docutils literal notranslate"><span class="pre">get_results_info()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mika.kd.trend_analysis.get_topics_per_doc"><code class="docutils literal notranslate"><span class="pre">get_topics_per_doc()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mika.kd.trend_analysis.get_word_frequencies"><code class="docutils literal notranslate"><span class="pre">get_word_frequencies()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mika.kd.trend_analysis.hazard_accuracy"><code class="docutils literal notranslate"><span class="pre">hazard_accuracy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mika.kd.trend_analysis.identify_docs_per_fmea_row"><code class="docutils literal notranslate"><span class="pre">identify_docs_per_fmea_row()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mika.kd.trend_analysis.identify_docs_per_hazard"><code class="docutils literal notranslate"><span class="pre">identify_docs_per_hazard()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mika.kd.trend_analysis.make_pie_chart"><code class="docutils literal notranslate"><span class="pre">make_pie_chart()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mika.kd.trend_analysis.minmax_scale"><code class="docutils literal notranslate"><span class="pre">minmax_scale()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mika.kd.trend_analysis.multiple_reg_feature_importance"><code class="docutils literal notranslate"><span class="pre">multiple_reg_feature_importance()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mika.kd.trend_analysis.plot_USFS_risk_matrix"><code class="docutils literal notranslate"><span class="pre">plot_USFS_risk_matrix()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mika.kd.trend_analysis.plot_frequency_time_series"><code class="docutils literal notranslate"><span class="pre">plot_frequency_time_series()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mika.kd.trend_analysis.plot_metric_averages"><code class="docutils literal notranslate"><span class="pre">plot_metric_averages()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mika.kd.trend_analysis.plot_metric_time_series"><code class="docutils literal notranslate"><span class="pre">plot_metric_time_series()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mika.kd.trend_analysis.plot_predictors"><code class="docutils literal notranslate"><span class="pre">plot_predictors()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mika.kd.trend_analysis.plot_risk_matrix"><code class="docutils literal notranslate"><span class="pre">plot_risk_matrix()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mika.kd.trend_analysis.proposed_topics"><code class="docutils literal notranslate"><span class="pre">proposed_topics()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mika.kd.trend_analysis.record_hazard_doc_info"><code class="docutils literal notranslate"><span class="pre">record_hazard_doc_info()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mika.kd.trend_analysis.regression_feature_importance"><code class="docutils literal notranslate"><span class="pre">regression_feature_importance()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mika.kd.trend_analysis.remove_outliers"><code class="docutils literal notranslate"><span class="pre">remove_outliers()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mika.kd.trend_analysis.reshape_correlation_matrix"><code class="docutils literal notranslate"><span class="pre">reshape_correlation_matrix()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mika.kd.trend_analysis.sample_for_accuracy"><code class="docutils literal notranslate"><span class="pre">sample_for_accuracy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mika.kd.trend_analysis.set_up_docs_per_hazard_vars"><code class="docutils literal notranslate"><span class="pre">set_up_docs_per_hazard_vars()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ir.html">ir package</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="data.html">Datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="models.html">Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">MIKA</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="components.html">MIKA</a></li>
      <li class="breadcrumb-item active">kd package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/kd.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="kd-package">
<h1>kd package<a class="headerlink" href="#kd-package" title="Permalink to this heading"></a></h1>
<section id="mika-kd-fmea">
<h2>mika.kd.FMEA<a class="headerlink" href="#mika-kd-fmea" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="mika.kd.FMEA">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mika.kd.</span></span><span class="sig-name descname"><span class="pre">FMEA</span></span><a class="headerlink" href="#mika.kd.FMEA" title="Permalink to this definition"></a></dt>
<dd><p>A class used for generated FMEAs from a data set of reports.</p>
<dl class="py method">
<dt class="sig sig-object py" id="mika.kd.FMEA.build_fmea">
<span class="sig-name descname"><span class="pre">build_fmea</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">severity_func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_by</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_by_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">post_process_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.FMEA.build_fmea" title="Permalink to this definition"></a></dt>
<dd><p>Builds the FMEA using the above functions, all in one call.
Less customizable, but useful for a quick implementation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>severity_func</strong> (<em>function</em>) – DESCRIPTION.</p></li>
<li><p><strong>group_by</strong> (<em>‘string’</em>) – method to group together the FMEA rows, either manual file or by meta data.</p></li>
<li><p><strong>year_col</strong> (<em>string</em>) – The column the year for the report is stored in.</p></li>
<li><p><strong>group_by_kwargs</strong> (<em>dict, optional</em>) – dictionary containing all inputs for the group_by function. The default is {}.</p></li>
<li><p><strong>post_process_kwargs</strong> (<em>dict, optional</em>) – dictionary containing all inputs for the post_process_fmea function. The default is {}.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mika.kd.FMEA.calc_frequency">
<span class="sig-name descname"><span class="pre">calc_frequency</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">year_col</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.FMEA.calc_frequency" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the frequency for each row and assigns it a category</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>year_col</strong> (<em>string</em>) – The column the year for the report is stored in.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>grouped_df</strong> – Grouped df with requency column added</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mika.kd.FMEA.calc_risk">
<span class="sig-name descname"><span class="pre">calc_risk</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.FMEA.calc_risk" title="Permalink to this definition"></a></dt>
<dd><p>Calculates risk as the product of severity and frequency.
Adds risk column to the grouped df.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mika.kd.FMEA.calc_severity">
<span class="sig-name descname"><span class="pre">calc_severity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">severity_func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">from_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.FMEA.calc_severity" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the severity for each row according to a defined severity function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>severity_func</strong> (<em>function</em>) – User defined function for calculating severity. Usually a linear combination of other values.</p></li>
<li><p><strong>from_file</strong> (<em>Boolean, optional</em>) – True if the severity value is already stored in a file, false if calculated from a severiy function. The default is False.</p></li>
<li><p><strong>file_name</strong> (<em>string, optional</em>) – filepath to a spread sheet containing the severity value for each document. The default is ‘’.</p></li>
<li><p><strong>file_kwargs</strong> (<em>dict, optional</em>) – any kwargs needed to read the file. Typically needed for .xlsx workbooks with multiple sheets. The default is {}.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mika.kd.FMEA.display_doc">
<span class="sig-name descname"><span class="pre">display_doc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">doc_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colors_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.FMEA.display_doc" title="Permalink to this definition"></a></dt>
<dd><p>Displays an annotated document with entities highlighted accordingly</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>doc_id</strong> (<em>string</em>) – The id of the document to be dispalyed</p></li>
<li><p><strong>save</strong> (<em>Boolean, optional</em>) – Saves as html if true. Displays if False. The default is True.</p></li>
<li><p><strong>output_path</strong> (<em>string, optional</em>) – The filepath the display will be saved to. The default is “”.</p></li>
<li><p><strong>colors_path</strong> (<em>string, optional</em>) – The path to a file that defines the colors to be used for each entity. The default is None.</p></li>
<li><p><strong>pred</strong> (<em>Boolean, optional</em>) – True if the displayed document is from predictions, False if from manual annotations. The default is True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>html</strong> – DESCRIPTION.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>TYPE</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mika.kd.FMEA.evaluate_preds">
<span class="sig-name descname"><span class="pre">evaluate_preds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_report</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.FMEA.evaluate_preds" title="Permalink to this definition"></a></dt>
<dd><p>Can only be used if the input data is labeled.
Evaluates the performance of the NER model against labeled data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cm</strong> (<em>Boolean, optional</em>) – Creates a confusion matrix if True. The default is True.</p></li>
<li><p><strong>class_report</strong> (<em>Boolean, optional</em>) – Creates a classification report if True. The default is True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>return_vals</strong> – Dict containing confusion matrix and classification report if specified.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mika.kd.FMEA.get_entities_per_doc">
<span class="sig-name descname"><span class="pre">get_entities_per_doc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.FMEA.get_entities_per_doc" title="Permalink to this definition"></a></dt>
<dd><p>Gets all entites for each document.
Note that this is required because the NER model is run on sentences.
This function reconstructs the documents from the sentences, while preserving the entities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pred</strong> (<em>Boolean, optional</em>) – True if the entities per doc are from predicted entities.
False if the entities per doc are from labels.
The default is True.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>pandas DataFrame with documents as rows, entities as columns</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>data_df</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mika.kd.FMEA.get_year_per_doc">
<span class="sig-name descname"><span class="pre">get_year_per_doc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">year_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'/'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.FMEA.get_year_per_doc" title="Permalink to this definition"></a></dt>
<dd><p>Used to convert dates to years prior to calculating frequency</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>year_col</strong> (<em>string,</em>) – The colomn in the raw dataframe with the date information.</p></li>
<li><p><strong>config</strong> (<em>TYPE, optional</em>) – DESCRIPTION. The default is ‘/’.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mika.kd.FMEA.group_docs_manual">
<span class="sig-name descname"><span class="pre">group_docs_manual</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grouping_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">additional_cols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.FMEA.group_docs_manual" title="Permalink to this definition"></a></dt>
<dd><p>Creates FMEA rows by grouping together documents according to values manually defined in a separate file.
Loads in the file and then aggregates the data. Sample IDs for documents in each row are created as well.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>string</em>) – filepath to the spreadsheet defining the rows.</p></li>
<li><p><strong>grouping_col</strong> (<em>string</em>) – The column within the spreadsheet that defines the rows.</p></li>
<li><p><strong>additional_cols</strong> (<em>list, optional</em>) – Additional columns to include in the FMEA.</p></li>
<li><p><strong>sample</strong> (<em>int, optional</em>) – Number of samples to pull for each FMEA row. The default is 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>grouped_df</strong> – The grouped FMEA dataframe</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mika.kd.FMEA.group_docs_with_meta">
<span class="sig-name descname"><span class="pre">group_docs_with_meta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grouping_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">additional_cols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.FMEA.group_docs_with_meta" title="Permalink to this definition"></a></dt>
<dd><p>Groups documents into an FMEA using a grouping column,
which is metadata from the initial dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grouping_col</strong> (<em>string</em>) – The column in the original dataset used to group documents into FMEA rows.</p></li>
<li><p><strong>additional_cols</strong> (<em>list of strings, optional</em>) – additional columns in a dataset to include in the FMEA. The default is [].</p></li>
<li><p><strong>sample</strong> (<em>int, optional</em>) – Number of samples to pull for each FMEA row. The default is 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>grouped_df</strong> – The grouped FMEA dataframe</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mika.kd.FMEA.load_data">
<span class="sig-name descname"><span class="pre">load_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filepath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">formatted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'labels'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.FMEA.load_data" title="Permalink to this definition"></a></dt>
<dd><p>Loads data to prepare for FMEA extraction.
Sentence tokenization is performed for preprocessing, and the raw data is also saved.
Can input a filepath for a .jsonl (annotations from doccano) or .csv file.
Can also instead input a dataframe already loaded in.
Can also instead input a huggingface dataset object location.
Saves data formatted to input into the NER model.
Requires spacy en_core_web_trf downloaded.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>text_col</strong> (<em>string</em>) – The column where the text used for FMEA extraction is stored.</p></li>
<li><p><strong>id_col</strong> (<em>string</em>) – The id column in the dataframe.</p></li>
<li><p><strong>filepath</strong> (<em>string, optional</em>) – Can input a filepath for a .jsonl (annotations from doccano) or .csv file. The default is ‘’.</p></li>
<li><p><strong>df</strong> (<em>pandas DataFrame, optional</em>) – Can instead input a pandas DataFrame already loaded in, with one column of text. The default is None.</p></li>
<li><p><strong>formatted</strong> (<em>Bool, optional</em>) – True if the input in filepath is a formatted dataset object. The default is False.</p></li>
<li><p><strong>label_col</strong> (<em>string, optional</em>) – The column containing annotation labels if the data is annotated. The default is “labels”.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mika.kd.FMEA.load_model">
<span class="sig-name descname"><span class="pre">load_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_checkpoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'NASA-AIML/MIKA_BERT_FMEA_NER'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.FMEA.load_model" title="Permalink to this definition"></a></dt>
<dd><p>Loads in a fine-tuned custom NER model trained to extract FMEA entities.
If no checkpoint is passed, the custom model from MIKA is used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_checkpoint</strong> (<em>string, optional</em>) – model check point, can be from huggingface or a path from personal device</p></li>
<li><p><strong>device</strong> (<em>int, optional</em>) – device to run model on. Default is -1 to run on cpu</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mika.kd.FMEA.post_process_fmea">
<span class="sig-name descname"><span class="pre">post_process_fmea</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ID'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Mission</span> <span class="pre">Type'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_words</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.FMEA.post_process_fmea" title="Permalink to this definition"></a></dt>
<dd><p>Post processes the FMEA to identify the column that contains the phase name,
clean sub-word tokens, and limit the number of words per cell.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>id_name</strong> (<em>string, optional</em>) – Name of dataset used/name over the id column. The default is ‘SAFECOM’.</p></li>
<li><p><strong>phase_name</strong> (<em>string, optional</em>) – Column that can be used to find the phase of operation. The default is ‘Mission Type’.</p></li>
<li><p><strong>max_words</strong> (<em>int, optional</em>) – Maximum number of words in a cell in the FMEA. The default is 20.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fmea_df</strong> – FMEA post processed DataFrame</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mika.kd.FMEA.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.FMEA.predict" title="Permalink to this definition"></a></dt>
<dd><p>Performs named entity recognition on the input data.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Predicted entities per each document</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Preds</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="mika-kd-topic-model-plus">
<h2>mika.kd.Topic_Model_plus<a class="headerlink" href="#mika-kd-topic-model-plus" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="mika.kd.Topic_Model_plus">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mika.kd.</span></span><span class="sig-name descname"><span class="pre">Topic_Model_plus</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text_columns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ngrams</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.Topic_Model_plus" title="Permalink to this definition"></a></dt>
<dd><p>Topic model plus</p>
<p>A class for topic modeling for aviation safety.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>text_columns</strong> (<em>list</em>) – defines various columns within a single database which will be used for topic modeling</p></li>
<li><p><strong>data</strong> (<a class="reference internal" href="utils.html#mika.utils.Data" title="mika.utils.Data"><em>Data</em></a>) – Data object storing the text corpus</p></li>
<li><p><strong>ngrams</strong> (<em>str</em>) – ‘tp’ if the user wants tomotopy to form ngrams prior to applying a topic model</p></li>
<li><p><strong>doc_ids</strong> (<em>list</em>) – list of document ids pulled from data object</p></li>
<li><p><strong>data_df</strong> (<em>pandas dataframe</em>) – df storing documents pulled from data object</p></li>
<li><p><strong>data_name</strong> (<em>string</em>) – dataset name pulled from data object</p></li>
<li><p><strong>id_col</strong> (<em>string</em>) – the column storing the document ids pulled from data object</p></li>
<li><p><strong>hlda_models</strong> (<em>dictionary</em>) – variable for storing hlda models</p></li>
<li><p><strong>lda_models</strong> (<em>dictionary</em>) – variable for storing lda models</p></li>
<li><p><strong>folder_path</strong> (<em>string</em>) – destination for storing results and models</p></li>
<li><p><strong>results_path</strong> (<em>string</em>) – destentation to create results folder in</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mika.kd.Topic_Model_plus.bert_topic">
<span class="sig-name descname"><span class="pre">bert_topic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sentence_transformer_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">umap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hdbscan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">count_vectorizor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ngram_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">3)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BERTkwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">from_probs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.Topic_Model_plus.bert_topic" title="Permalink to this definition"></a></dt>
<dd><p>Train a bertopic model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sentence_transformer_model</strong> (<em>BERT model object, optional</em>) – BERT model object used for embeddings. The default is None.</p></li>
<li><p><strong>umap</strong> (<em>umap model object, optional</em>) – umap model object used for dimensionality reduction. The default is None.</p></li>
<li><p><strong>hdbscan</strong> (<em>hdbscan model object, optional</em>) – hdbscan model object for clustering. The default is None.</p></li>
<li><p><strong>count_vectorizor</strong> (<em>count vectorizor object, optional</em>) – count vectorizor object that is used for ctf-idf. The default is None.</p></li>
<li><p><strong>ngram_range</strong> (<em>tuple, optional</em>) – range of ngrams to be considered. The default is (1,3).</p></li>
<li><p><strong>BERTkwargs</strong> (<em>dict, optional</em>) – dictionary of kwargs passed into bertopic. The default is {}.</p></li>
<li><p><strong>from_probs</strong> (<em>boolean, optional</em>) – true to assign topics to documents based on a probability threshold (i.e., documents can have multiple topics).
The default is True.</p></li>
<li><p><strong>thresh</strong> (<em>float, optional</em>) – probability threshold used when from_probs=True. The default is 0.01.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mika.kd.Topic_Model_plus.calc_bert_coherence">
<span class="sig-name descname"><span class="pre">calc_bert_coherence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">docs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">topics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">topic_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'u_mass'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_words</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.Topic_Model_plus.calc_bert_coherence" title="Permalink to this definition"></a></dt>
<dd><p>Calculates coherence for a bertopic model using gensim coherence models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>docs</strong> (<em>list</em>) – List of document text.</p></li>
<li><p><strong>topics</strong> (<em>List</em>) – List of topics per document.</p></li>
<li><p><strong>topic_model</strong> (<em>BERTopic model object</em>) – Object containing the trained topic model.</p></li>
<li><p><strong>method</strong> (<em>string, optional</em>) – Method used to calculate coherence. Can be any method used in gensim.
The default is ‘u_mass’.</p></li>
<li><p><strong>num_words</strong> (<em>int, optional</em>) – Number of words in the topic used to calculate coherence. The default is 10.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>coherence_per_topic</strong> – List of coherence scores for each topic.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mika.kd.Topic_Model_plus.coherence_scores">
<span class="sig-name descname"><span class="pre">coherence_scores</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mdl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lda_or_hlda</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">measure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'c_v'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.Topic_Model_plus.coherence_scores" title="Permalink to this definition"></a></dt>
<dd><p>Computes and returns coherence scores for lda and hlda models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mdl</strong> (<em>lda or hlda model object</em>) – topic model object created previously</p></li>
<li><p><strong>lda_or_hlda</strong> (<em>str</em>) – denotes whether coherence is being calculated for lda or hlda</p></li>
<li><p><strong>measure</strong> (<em>string, optional</em>) – denotes which coherence metric to compute. The default is ‘c_v’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>scores</strong> – coherence scores, averages, and std dev</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mika.kd.Topic_Model_plus.get_bert_coherence">
<span class="sig-name descname"><span class="pre">get_bert_coherence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coh_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'u_mass'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">from_probs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.Topic_Model_plus.get_bert_coherence" title="Permalink to this definition"></a></dt>
<dd><p>Gets coherence for bert models and saves it in a dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coh_method</strong> (<em>string, optional</em>) – Method used to calculate coherence. Can be any method used in gensim.
The default is ‘u_mass’.</p></li>
<li><p><strong>from_probs</strong> (<em>boolean, optional</em>) – Whether or not to use document topic probabilities to assign topics.
True to use probabilities - i.e., each document can have multiple topics.
False to not use probabilities - i.e., each document only has one topics.
The default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mika.kd.Topic_Model_plus.get_bert_topic_diversity">
<span class="sig-name descname"><span class="pre">get_bert_topic_diversity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">topk</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.Topic_Model_plus.get_bert_topic_diversity" title="Permalink to this definition"></a></dt>
<dd><p>Gets topic diversity scores for a BERTopic model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>topk</strong> (<em>int, optional</em>) – Number of words per topic used to calculate diversity. The default is 10.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mika.kd.Topic_Model_plus.get_bert_topics_from_probs">
<span class="sig-name descname"><span class="pre">get_bert_topics_from_probs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">topic_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coherence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.Topic_Model_plus.get_bert_topics_from_probs" title="Permalink to this definition"></a></dt>
<dd><p>Saves topic model results including each topic number, words, number of words,
and best document when document topics are defined by a probabilty threshold.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>topic_df</strong> (<em>dictionary of dataframes</em>) – dictionary of dataframes where each key is a text column and each value is the corresponding
topic model results</p></li>
<li><p><strong>thresh</strong> (<em>float, optional</em>) – probability threshold used when from_probs=True. The default is 0.01.</p></li>
<li><p><strong>coherence</strong> (<em>boolean, optional</em>) – true to calculate coherence for the model and save the results. The default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>new_topic_dfs</strong> – dictionary of dataframes where each key is a text column and each value is the corresponding
topic model results</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dictionary of dataframes</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mika.kd.Topic_Model_plus.hdp">
<span class="sig-name descname"><span class="pre">hdp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">training_iterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iteration_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_lda</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">topic_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.Topic_Model_plus.hdp" title="Permalink to this definition"></a></dt>
<dd><p>Performs HDP topic modeling which is useful when the number of topics is not known.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>training_iterations</strong> (<em>int, optional</em>) – number of training iterations. The default is 1000.</p></li>
<li><p><strong>iteration_step</strong> (<em>int, optional</em>) – number of steps per iteration. The default is 10.</p></li>
<li><p><strong>to_lda</strong> (<em>boolean, optional</em>) – True to convert the hdp model to an lda model. The default is True.</p></li>
<li><p><strong>kwargs</strong> (<em>dict, optional</em>) – kwargs to pass into the hdp model. The default is {}.</p></li>
<li><p><strong>topic_threshold</strong> (<em>float, optional</em>) – probability threshold used when converting hdp topics to lda topics. The default is 0.0.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mika.kd.Topic_Model_plus.hlda">
<span class="sig-name descname"><span class="pre">hlda</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">levels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_iterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iteration_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.Topic_Model_plus.hlda" title="Permalink to this definition"></a></dt>
<dd><p>Performs hlda topic modeling.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>levels</strong> (<em>int, optional</em>) – number of hierarchical levels. The default is 3.</p></li>
<li><p><strong>training_iterations</strong> (<em>int, optional</em>) – number of training iterations. The default is 1000.</p></li>
<li><p><strong>iteration_step</strong> (<em>int, optional</em>) – number of steps per iteration. The default is 10.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em>) – any kwargs for the hlda topic model</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mika.kd.Topic_Model_plus.hlda_display">
<span class="sig-name descname"><span class="pre">hlda_display</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_words</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">display_options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'level</span> <span class="pre">1':</span> <span class="pre">1,</span> <span class="pre">'level</span> <span class="pre">2':</span> <span class="pre">6}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bupu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.Topic_Model_plus.hlda_display" title="Permalink to this definition"></a></dt>
<dd><p>Saves graphviz visualization of hlda tree structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>col</strong> (<em>string</em>) – column of interest</p></li>
<li><p><strong>num_words</strong> (<em>int, optional</em>) – number of words per node. The default is 5.</p></li>
<li><p><strong>display_options</strong> (<em>dictionary, optional</em>) – nested dictiary where keys are levels and values are the max number of nodes.
The default is {“level 1”: 1, “level 2”: 6}.</p></li>
<li><p><strong>colors</strong> (<em>string, optional</em>) – brewer colorscheme used, default is blue-purple
see <a class="reference external" href="http://graphviz.org/doc/info/colors.html#brewer">http://graphviz.org/doc/info/colors.html#brewer</a> for options.
The default is ‘bupu’.</p></li>
<li><p><strong>filename</strong> (<em>string, optional</em>) – can input a filename for where the topics are stored in order to make display
after hlda; must be an ouput from “save_hlda_topics()” or hlda.bin object.
The default is ‘’.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mika.kd.Topic_Model_plus.hlda_extract_models">
<span class="sig-name descname"><span class="pre">hlda_extract_models</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.Topic_Model_plus.hlda_extract_models" title="Permalink to this definition"></a></dt>
<dd><p>Gets hlda models from file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file_path</strong> (<em>string</em>) – path to file</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mika.kd.Topic_Model_plus.hlda_visual">
<span class="sig-name descname"><span class="pre">hlda_visual</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">col</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.Topic_Model_plus.hlda_visual" title="Permalink to this definition"></a></dt>
<dd><p>Saves pyLDAvis output from hlda to file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>col</strong> (<em>str</em>) – reference to column of interest</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mika.kd.Topic_Model_plus.label_hlda_topics">
<span class="sig-name descname"><span class="pre">label_hlda_topics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">extractor_min_cf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extractor_min_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extractor_max_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extractor_max_cand</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labeler_min_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labeler_smoothing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labeler_mu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_top_n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.Topic_Model_plus.label_hlda_topics" title="Permalink to this definition"></a></dt>
<dd><p>Uses tomotopy’s auto topic labeling tool to label topics. Stores labels in class; after running this function, a flag can be used to use labels or not in taxonomy saving functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>extractor_min_cf</strong> (<em>int</em>) – from tomotopy docs: “minimum collection frequency of collocations. Collocations with a smaller collection frequency than min_cf are excluded from the candidates. Set this value large if the corpus is big”</p></li>
<li><p><strong>extractor_min_df</strong> (<em>int</em>) – from tomotopy docs: “minimum document frequency of collocations. Collocations with a smaller document frequency than min_df are excluded from the candidates. Set this value large if the corpus is big”</p></li>
<li><p><strong>extractor_max_len</strong> (<em>int</em>) – from tomotopy docs: “maximum length of collocations”</p></li>
<li><p><strong>extractor_max_cand</strong> (<em>int</em>) – from tomotopy docs: “maximum number of candidates to extract”</p></li>
<li><p><strong>labeler_min_df</strong> (<em>int</em>) – from tomotopy docs: “minimum document frequency of collocations. Collocations with a smaller document frequency than min_df are excluded from the candidates. Set this value large if the corpus is big”</p></li>
<li><p><strong>labeler_smoothing</strong> (<em>float</em>) – from tomotopy docs: “a small value greater than 0 for Laplace smoothing”</p></li>
<li><p><strong>labeler_mu</strong> (<em>float</em>) – from tomotopy docs: “a discriminative coefficient. Candidates with high score on a specific topic and with low score on other topics get the higher final score when this value is the larger.”</p></li>
<li><p><strong>label_top_n</strong> (<em>int</em>) – from tomotopy docs: “the number of labels”</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mika.kd.Topic_Model_plus.label_lda_topics">
<span class="sig-name descname"><span class="pre">label_lda_topics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">extractor_min_cf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extractor_min_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extractor_max_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extractor_max_cand</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labeler_min_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labeler_smoothing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labeler_mu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_top_n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.Topic_Model_plus.label_lda_topics" title="Permalink to this definition"></a></dt>
<dd><p>Uses tomotopy’s auto topic labeling tool to label topics. Stores labels in class; after running this function, a flag can be used to use labels or not in taxonomy saving functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>extractor_min_cf</strong> (<em>int</em>) – from tomotopy docs: “minimum collection frequency of collocations. Collocations with a smaller collection frequency than min_cf are excluded from the candidates. Set this value large if the corpus is big”</p></li>
<li><p><strong>extractor_min_df</strong> (<em>int</em>) – from tomotopy docs: “minimum document frequency of collocations. Collocations with a smaller document frequency than min_df are excluded from the candidates. Set this value large if the corpus is big”</p></li>
<li><p><strong>extractor_max_len</strong> (<em>int</em>) – from tomotopy docs: “maximum length of collocations”</p></li>
<li><p><strong>extractor_max_cand</strong> (<em>int</em>) – from tomotopy docs: “maximum number of candidates to extract”</p></li>
<li><p><strong>labeler_min_df</strong> (<em>int</em>) – from tomotopy docs: “minimum document frequency of collocations. Collocations with a smaller document frequency than min_df are excluded from the candidates. Set this value large if the corpus is big”</p></li>
<li><p><strong>labeler_smoothing</strong> (<em>float</em>) – from tomotopy docs: “a small value greater than 0 for Laplace smoothing”</p></li>
<li><p><strong>labeler_mu</strong> (<em>float</em>) – from tomotopy docs: “a discriminative coefficient. Candidates with high score on a specific topic and with low score on other topics get the higher final score when this value is the larger.”</p></li>
<li><p><strong>label_top_n</strong> (<em>int</em>) – from tomotopy docs: “the number of labels”</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mika.kd.Topic_Model_plus.lda">
<span class="sig-name descname"><span class="pre">lda</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_topics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_iterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iteration_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_topics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.Topic_Model_plus.lda" title="Permalink to this definition"></a></dt>
<dd><p>Performs LDA topic modeling.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_topics</strong> (<em>dict, optional</em>) – keys are columns in text_columns, values are the number of topics lda forms
optional - if omitted, lda optimization is run and produces the num_topics The default is {}.</p></li>
<li><p><strong>training_iterations</strong> (<em>int, optional</em>) – number of training iterations. The default is 1000.</p></li>
<li><p><strong>iteration_step</strong> (<em>int, optional</em>) – number of steps per iteration. The default is 10.</p></li>
<li><p><strong>max_topics</strong> (<em>int, optional</em>) – maximum number of topics to consider The default is 0.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em>) – any kwargs for the lda topic model.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mika.kd.Topic_Model_plus.lda_extract_models">
<span class="sig-name descname"><span class="pre">lda_extract_models</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.Topic_Model_plus.lda_extract_models" title="Permalink to this definition"></a></dt>
<dd><p>Loads lda models from file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file_path</strong> (<em>str</em>) – path to file</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mika.kd.Topic_Model_plus.lda_visual">
<span class="sig-name descname"><span class="pre">lda_visual</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">col</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.Topic_Model_plus.lda_visual" title="Permalink to this definition"></a></dt>
<dd><p>Saves pyLDAvis output from lda to file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>col</strong> (<em>str</em>) – reference to column of interest</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mika.kd.Topic_Model_plus.load_bert_model">
<span class="sig-name descname"><span class="pre">load_bert_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduced</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">from_probs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.Topic_Model_plus.load_bert_model" title="Permalink to this definition"></a></dt>
<dd><p>Loads trained bertopic model(s).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_path</strong> (<em>string</em>) – file path to the folder storing the model(s)</p></li>
<li><p><strong>reduced</strong> (<em>bool, optional</em>) – True if the model is a reduced topic model, by default False</p></li>
<li><p><strong>from_probs</strong> (<em>bool, optional</em>) – Whether or not to use document topic probabilities to assign topics.
True to use probabilities - i.e., each document can have multiple topics.
False to not use probabilities - i.e., each document only has one topics, by default False</p></li>
<li><p><strong>thresh</strong> (<em>float, optional</em>) – probability threshold used when from_probs=True, by default 0.01</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mika.kd.Topic_Model_plus.reduce_bert_topics">
<span class="sig-name descname"><span class="pre">reduce_bert_topics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">from_probs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.Topic_Model_plus.reduce_bert_topics" title="Permalink to this definition"></a></dt>
<dd><p>Reduces the number of topics in a trained bertopic model to the specified number.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num</strong> (<em>int optional</em>) – number of topics in the reduced model. The default is 30.</p></li>
<li><p><strong>from_probs</strong> (<em>boolean, optional</em>) – true to assign topics to documents based on a probability threshold (i.e., documents can have multiple topics).
The default is True.</p></li>
<li><p><strong>thresh</strong> (<em>float, optional</em>) – probability threshold used when from_probs=True. The default is 0.01.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mika.kd.Topic_Model_plus.save_bert_coherence">
<span class="sig-name descname"><span class="pre">save_bert_coherence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">return_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coh_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'u_mass'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">from_probs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.Topic_Model_plus.save_bert_coherence" title="Permalink to this definition"></a></dt>
<dd><p>Saves the coherence scores for a bertopic model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>return_df</strong> (<em>boolean, optional</em>) – True to return the coherence_df. The default is False.</p></li>
<li><p><strong>coh_method</strong> (<em>string, optional</em>) – Method used to calculate coherence. Can be any method used in gensim.
The default is ‘u_mass’.</p></li>
<li><p><strong>from_probs</strong> (<em>boolean, optional</em>) – Whether or not to use document topic probabilities to assign topics.
True to use probabilities - i.e., each document can have multiple topics.
False to not use probabilities - i.e., each document only has one topics.
The default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>coherence_df</strong> – Dataframe with each row a topic, column has coherence scores.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mika.kd.Topic_Model_plus.save_bert_document_topic_distribution">
<span class="sig-name descname"><span class="pre">save_bert_document_topic_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">return_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.Topic_Model_plus.save_bert_document_topic_distribution" title="Permalink to this definition"></a></dt>
<dd><p>Saves the document topic distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>return_df</strong> (<em>boolean, optional</em>) – True to return the results df. The default is False.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>doc_df</strong> – dataframe with a row for each document and the probability for each topic</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mika.kd.Topic_Model_plus.save_bert_model">
<span class="sig-name descname"><span class="pre">save_bert_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">embedding_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.Topic_Model_plus.save_bert_model" title="Permalink to this definition"></a></dt>
<dd><p>Saves a BERTopic model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>embedding_model</strong> (<em>boolean, optional</em>) – True to save the embedding model. The default is True.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mika.kd.Topic_Model_plus.save_bert_results">
<span class="sig-name descname"><span class="pre">save_bert_results</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coherence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coh_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'u_mass'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">from_probs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">topk</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.Topic_Model_plus.save_bert_results" title="Permalink to this definition"></a></dt>
<dd><p>Saves the taxonomy, coherence, and document topic distribution in one excel file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coherence</strong> (<em>boolean, optional</em>) – true to calculate coherence for the model and save the results. The default is False.</p></li>
<li><p><strong>coh_method</strong> (<em>string, optional</em>) – Method used to calculate coherence. Can be any method used in gensim.
The default is ‘u_mass’.</p></li>
<li><p><strong>from_probs</strong> (<em>boolean, optional</em>) – true to assign topics to documents based on a probability threshold (i.e., documents can have multiple topics).
The default is False.</p></li>
<li><p><strong>thresh</strong> (<em>float, optional</em>) – probability threshold used when from_probs=True. The default is 0.01.</p></li>
<li><p><strong>topk</strong> (<em>int, optional</em>) – Number of words per topic used to calculate diversity. The default is 10.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mika.kd.Topic_Model_plus.save_bert_taxonomy">
<span class="sig-name descname"><span class="pre">save_bert_taxonomy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">return_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_thres</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.Topic_Model_plus.save_bert_taxonomy" title="Permalink to this definition"></a></dt>
<dd><p>Saves a taxonomy of topics from bertopic model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>return_df</strong> (<em>boolean, optional</em>) – True to return the results dfs. The default is False.</p></li>
<li><p><strong>p_thres</strong> (<em>float, optional</em>) – word-topic probability threshold required for a word to be considered in a topic.
The default is 0.0001.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>taxonomy_df</strong> – taxonomy dataframe with a column for each text column and each row a
unique combination of topics found in the documents</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas Dataframe</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mika.kd.Topic_Model_plus.save_bert_topic_diversity">
<span class="sig-name descname"><span class="pre">save_bert_topic_diversity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">topk</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.Topic_Model_plus.save_bert_topic_diversity" title="Permalink to this definition"></a></dt>
<dd><p>Saves topic diversity score for a bertopic model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>topk</strong> (<em>int, optional</em>) – Number of words per topic used to calculate diversity. The default is 10.</p></li>
<li><p><strong>return_df</strong> (<em>boolean, optional</em>) – True to return the diversity_df. The default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>diversity_df</strong> – Dataframe with topic diversity score.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mika.kd.Topic_Model_plus.save_bert_topics">
<span class="sig-name descname"><span class="pre">save_bert_topics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">return_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_thres</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coherence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coh_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'u_mass'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">from_probs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.Topic_Model_plus.save_bert_topics" title="Permalink to this definition"></a></dt>
<dd><p>Saves bert topics results to file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>return_df</strong> (<em>boolean, optional</em>) – True to return the results dfs. The default is False.</p></li>
<li><p><strong>p_thres</strong> (<em>float, optional</em>) – word-topic probability threshold required for a word to be considered in a topic.
The default is 0.0001.</p></li>
<li><p><strong>coherence</strong> (<em>boolean, optional</em>) – true to calculate coherence for the model and save the results. The default is False.</p></li>
<li><p><strong>coh_method</strong> (<em>string, optional</em>) – Method used to calculate coherence. Can be any method used in gensim.
The default is ‘u_mass’.</p></li>
<li><p><strong>from_probs</strong> (<em>boolean, optional</em>) – true to assign topics to documents based on a probability threshold (i.e., documents can have multiple topics).
The default is True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>dfs</strong> – dictionary of dataframes where each key is a text column and each value is the corresponding
topic model results</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dictionary of dataframes</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mika.kd.Topic_Model_plus.save_bert_topics_from_probs">
<span class="sig-name descname"><span class="pre">save_bert_topics_from_probs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coherence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coh_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'u_mass'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">from_probs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.Topic_Model_plus.save_bert_topics_from_probs" title="Permalink to this definition"></a></dt>
<dd><p>Saves bertopic model results if using probability threshold.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>thresh</strong> (<em>float, optional</em>) – probability threshold used when from_probs=True. The default is 0.01.</p></li>
<li><p><strong>return_df</strong> (<em>boolean, optional</em>) – True to return the results dfs. The default is False.</p></li>
<li><p><strong>coherence</strong> (<em>boolean, optional</em>) – true to calculate coherence for the model and save the results. The default is False.</p></li>
<li><p><strong>coh_method</strong> (<em>string, optional</em>) – Method used to calculate coherence. Can be any method used in gensim.
The default is ‘u_mass’.</p></li>
<li><p><strong>from_probs</strong> (<em>boolean, optional</em>) – true to assign topics to documents based on a probability threshold (i.e., documents can have multiple topics).
The default is True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>topic_prob_dfs</strong> – dictionary of dataframes where each key is a text column and each value is the corresponding
topic model results</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dictionary of dataframes</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mika.kd.Topic_Model_plus.save_bert_vis">
<span class="sig-name descname"><span class="pre">save_bert_vis</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.Topic_Model_plus.save_bert_vis" title="Permalink to this definition"></a></dt>
<dd><p>Saves the bertopic visualization and hierarchy visualization.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mika.kd.Topic_Model_plus.save_hlda_coherence">
<span class="sig-name descname"><span class="pre">save_hlda_coherence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">return_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.Topic_Model_plus.save_hlda_coherence" title="Permalink to this definition"></a></dt>
<dd><p>Saves hlda coherence to file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>return_df</strong> (<em>boolean, optional</em>) – True to return the results df. The default is False.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>coherence_df</strong> – Dataframe with each row a topic, column has coherence scores.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mika.kd.Topic_Model_plus.save_hlda_document_topic_distribution">
<span class="sig-name descname"><span class="pre">save_hlda_document_topic_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">return_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.Topic_Model_plus.save_hlda_document_topic_distribution" title="Permalink to this definition"></a></dt>
<dd><p>Saves hlda document topic distribution to file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>return_df</strong> (<em>boolean, optional</em>) – True to return the results df. The default is False.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>doc_df</strong> – dataframe with a row for each document and the probability for each topic</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mika.kd.Topic_Model_plus.save_hlda_level_n_taxonomy">
<span class="sig-name descname"><span class="pre">save_hlda_level_n_taxonomy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.Topic_Model_plus.save_hlda_level_n_taxonomy" title="Permalink to this definition"></a></dt>
<dd><p>Saves hlda taxonomy at level n.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lev</strong> (<em>int, optional</em>) – the level number to save. The default is 1.</p></li>
<li><p><strong>return_df</strong> (<em>boolean, optional</em>) – True to return the results df. The default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>taxonomy_level_df</strong> – Taxonomy dataframe with a column for each text column and each row a
unique combination of topics found in the documents</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas Dataframe</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mika.kd.Topic_Model_plus.save_hlda_models">
<span class="sig-name descname"><span class="pre">save_hlda_models</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.Topic_Model_plus.save_hlda_models" title="Permalink to this definition"></a></dt>
<dd><p>Saves hlda models to file.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mika.kd.Topic_Model_plus.save_hlda_results">
<span class="sig-name descname"><span class="pre">save_hlda_results</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.Topic_Model_plus.save_hlda_results" title="Permalink to this definition"></a></dt>
<dd><p>Saves the taxonomy, level 1 taxonomy, raw topics coherence, and document topic distribution in one excel file.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mika.kd.Topic_Model_plus.save_hlda_taxonomy">
<span class="sig-name descname"><span class="pre">save_hlda_taxonomy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">return_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_words</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.Topic_Model_plus.save_hlda_taxonomy" title="Permalink to this definition"></a></dt>
<dd><p>Saves hlda taxonomy to file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>return_df</strong> (<em>boolean, optional</em>) – True to return the results df. The default is False.</p></li>
<li><p><strong>use_labels</strong> (<em>boolean, optional</em>) – True to use topic labels generated from tomotopy. The default is False.</p></li>
<li><p><strong>num_words</strong> (<em>int, optional</em>) – Number of words to display in the taxonomy. The default is 10.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>taxonomy_df</strong> – Taxonomy dataframe with a column for each text column and each row a
unique combination of topics found in the documents</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas Dataframe</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mika.kd.Topic_Model_plus.save_hlda_topics">
<span class="sig-name descname"><span class="pre">save_hlda_topics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">return_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_thres</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.Topic_Model_plus.save_hlda_topics" title="Permalink to this definition"></a></dt>
<dd><p>Saves hlda topics to file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>return_df</strong> (<em>boolean, optional</em>) – True to return the results df. The default is False.</p></li>
<li><p><strong>p_thres</strong> (<em>float, optional</em>) – word-topic probability threshold required for a word to be considered in a topic.
The default is 0.001.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>dfs</strong> – dictionary of dataframes where each key is a text column and each value is the corresponding
topic model results</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dictionary of dataframes</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mika.kd.Topic_Model_plus.save_lda_coherence">
<span class="sig-name descname"><span class="pre">save_lda_coherence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">return_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.Topic_Model_plus.save_lda_coherence" title="Permalink to this definition"></a></dt>
<dd><p>Saves lda coherence to file or returns the dataframe to another function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>return_df</strong> (<em>boolean, optional</em>) – True to return the results df. The default is False.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>coherence_df</strong> – Dataframe with each row a topic, column has coherence scores.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mika.kd.Topic_Model_plus.save_lda_document_topic_distribution">
<span class="sig-name descname"><span class="pre">save_lda_document_topic_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">return_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.Topic_Model_plus.save_lda_document_topic_distribution" title="Permalink to this definition"></a></dt>
<dd><p>Saves lda document topic distribution to file or returns the dataframe to another function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>return_df</strong> (<em>boolean, optional</em>) – True to return the results df. The default is False.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>doc_df</strong> – dataframe with a row for each document and the probability for each topic</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mika.kd.Topic_Model_plus.save_lda_models">
<span class="sig-name descname"><span class="pre">save_lda_models</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.Topic_Model_plus.save_lda_models" title="Permalink to this definition"></a></dt>
<dd><p>Saves lda models to file.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mika.kd.Topic_Model_plus.save_lda_results">
<span class="sig-name descname"><span class="pre">save_lda_results</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.Topic_Model_plus.save_lda_results" title="Permalink to this definition"></a></dt>
<dd><p>Saves the taxonomy, coherence, and document topic distribution in one excel file.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mika.kd.Topic_Model_plus.save_lda_taxonomy">
<span class="sig-name descname"><span class="pre">save_lda_taxonomy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">return_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_words</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.Topic_Model_plus.save_lda_taxonomy" title="Permalink to this definition"></a></dt>
<dd><p>Saves lda taxonomy to file or returns the dataframe to another function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>return_df</strong> (<em>boolean, optional</em>) – True to return the results df. The default is False.</p></li>
<li><p><strong>use_labels</strong> (<em>boolean, optional</em>) – True to use topic labels generated from tomotopy. The default is False.</p></li>
<li><p><strong>num_words</strong> (<em>int, optional</em>) – Number of words to display in the taxonomy. The default is 10.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>taxonomy_df</strong> – Taxonomy dataframe with a column for each text column and each row a
unique combination of topics found in the documents</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas Dataframe</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mika.kd.Topic_Model_plus.save_lda_topics">
<span class="sig-name descname"><span class="pre">save_lda_topics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">return_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_thres</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.Topic_Model_plus.save_lda_topics" title="Permalink to this definition"></a></dt>
<dd><p>Saves lda topics to file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>return_df</strong> (<em>boolean, optional</em>) – True to return the results df. The default is False.</p></li>
<li><p><strong>p_thres</strong> (<em>float, optional</em>) – word-topic probability threshold required for a word to be considered in a topic.
The default is 0.001.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>dfs</strong> – dictionary of dataframes where each key is a text column and each value is the corresponding
topic model results</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dictionary of dataframes</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mika.kd.Topic_Model_plus.save_mixed_taxonomy">
<span class="sig-name descname"><span class="pre">save_mixed_taxonomy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">use_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.Topic_Model_plus.save_mixed_taxonomy" title="Permalink to this definition"></a></dt>
<dd><p>A custom mixed lda/hlda model taxonomy. Must run lda and hlda with desired parameters first.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>use_labels</strong> (<em>boolean, optional</em>) – True to use topic labels. The default is False.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-mika.kd.NER">
<span id="mika-kd-ner"></span><h2>mika.kd.NER<a class="headerlink" href="#module-mika.kd.NER" title="Permalink to this heading"></a></h2>
<p>Description: Utility functions for training custom NER models.</p>
<dl class="py function">
<dt class="sig sig-object py" id="mika.kd.NER.align_labels_with_tokens">
<span class="sig-prename descclassname"><span class="pre">mika.kd.NER.</span></span><span class="sig-name descname"><span class="pre">align_labels_with_tokens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">word_ids</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.NER.align_labels_with_tokens" title="Permalink to this definition"></a></dt>
<dd><p>Aligns labels and tokens for model training.
Adds special tokens to identify tokens not in the tokenizer and the begining of new words.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>labels</strong> (<em>list</em>) – List of NER labels where each label is a string</p></li>
<li><p><strong>word_ids</strong> (<em>list</em>) – List of work ids generated from a tokenizer</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>new_labels</strong> – List of new labels with special token labels added.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mika.kd.NER.build_confusion_matrix">
<span class="sig-prename descclassname"><span class="pre">mika.kd.NER.</span></span><span class="sig-name descname"><span class="pre">build_confusion_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pred_labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savepath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.NER.build_confusion_matrix" title="Permalink to this definition"></a></dt>
<dd><p>Creates confusion matrix for the muliclass NER classification.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>labels</strong> (<em>list</em>) – true labels</p></li>
<li><p><strong>preds</strong> (<em>Numpy Array</em>) – predictions output from model</p></li>
<li><p><strong>pred_labels</strong> (<em>List</em>) – token labels corresponding to predictions. Used for removing special tokens</p></li>
<li><p><strong>label_list</strong> (<em>Dict</em>) – Maps label ids to NER labels.</p></li>
<li><p><strong>save</strong> (<em>Boolean, optional</em>) – True to save the figure as pdf, false to not save. The default is False.</p></li>
<li><p><strong>savepath</strong> (<em>string, optional</em>) – Path to save the figure to. The default is “”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>conf_mat</strong> (<em>pandas DataFrame</em>) – confusion matrix object</p></li>
<li><p><strong>true_predictions</strong> (<em>list</em>) – List of model prediction labels</p></li>
<li><p><strong>true_labels</strong> (<em>list</em>) – List of true labels</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mika.kd.NER.check_doc_to_sentence_split">
<span class="sig-prename descclassname"><span class="pre">mika.kd.NER.</span></span><span class="sig-name descname"><span class="pre">check_doc_to_sentence_split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sentence_df</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.NER.check_doc_to_sentence_split" title="Permalink to this definition"></a></dt>
<dd><p>Tests that tags are preserved during document to sentence split.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>sentence_df</strong> (<em>pandas DataFrame</em>) – Dataframe where each row is a sentence. Has columns ‘sentence’ and ‘tags’</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mika.kd.NER.clean_annots_from_str">
<span class="sig-prename descclassname"><span class="pre">mika.kd.NER.</span></span><span class="sig-name descname"><span class="pre">clean_annots_from_str</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.NER.clean_annots_from_str" title="Permalink to this definition"></a></dt>
<dd><p>Cleans annotated documents by removing excess symbols.
Use if the text is a string from a list of words.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>df</strong> (<em>pandas dataframe</em>) – Dataframe of the annotated document set.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>df</strong> – Dataframe of the cleaned annotated document set.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas dataframe</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mika.kd.NER.clean_doccano_annots">
<span class="sig-prename descclassname"><span class="pre">mika.kd.NER.</span></span><span class="sig-name descname"><span class="pre">clean_doccano_annots</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.NER.clean_doccano_annots" title="Permalink to this definition"></a></dt>
<dd><p>Cleans annotated documents.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>df</strong> (<em>pandas dataframe</em>) – Dataframe of the annotated document set.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>df</strong> – Dataframe of the cleaned annotated document set.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas dataframe</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mika.kd.NER.clean_text_tags">
<span class="sig-prename descclassname"><span class="pre">mika.kd.NER.</span></span><span class="sig-name descname"><span class="pre">clean_text_tags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.NER.clean_text_tags" title="Permalink to this definition"></a></dt>
<dd><p>Cleans an individual text and label set by removing extra spaces or punctuation at
the beginning or end of a string, fixing annotations that are missing a proceeding
or preceeding character, and adding spaces into text that is misisng a space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>text</strong> (<em>string</em>) – text accosicated with the labels</p></li>
<li><p><strong>labels</strong> (<em>list</em>) – list of labels from annotation where each label in the list is a tuple with
structure (1,2,3), where 1 is the beginning character location, 2 is the end character
location, and 3 is the label name</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>new_labels</strong> (<em>list</em>) – cleaned list of labels</p></li>
<li><p><strong>text</strong> (<em>string</em>) – cleaned string corresponding to the labels.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mika.kd.NER.compute_classification_report">
<span class="sig-prename descclassname"><span class="pre">mika.kd.NER.</span></span><span class="sig-name descname"><span class="pre">compute_classification_report</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pred_labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_list</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.NER.compute_classification_report" title="Permalink to this definition"></a></dt>
<dd><p>Computes classification report.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>labels</strong> (<em>list</em>) – true labels</p></li>
<li><p><strong>preds</strong> (<em>Numpy Array</em>) – predictions output from model</p></li>
<li><p><strong>pred_labels</strong> (<em>List</em>) – token labels corresponding to predictions. Used for removing special tokens</p></li>
<li><p><strong>label_list</strong> (<em>Dict</em>) – Maps label ids to NER labels.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Output of classification results</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Classification Report</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mika.kd.NER.compute_metrics">
<span class="sig-prename descclassname"><span class="pre">mika.kd.NER.</span></span><span class="sig-name descname"><span class="pre">compute_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eval_preds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id2label</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.NER.compute_metrics" title="Permalink to this definition"></a></dt>
<dd><p>Calculates sequence classification metrics. Used during trainig.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eval_preds</strong> (<em>Tensor</em>) – Pytorch tensor generated during training/evaluation.</p></li>
<li><p><strong>id2label</strong> (<em>Dict</em>) – Dict mapping numeric ids to labels.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Dict of metrics.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mika.kd.NER.get_cleaned_label">
<span class="sig-prename descclassname"><span class="pre">mika.kd.NER.</span></span><span class="sig-name descname"><span class="pre">get_cleaned_label</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.NER.get_cleaned_label" title="Permalink to this definition"></a></dt>
<dd><p>removes BILOU component of tag</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>label</strong> (<em>string</em>) – NER label potentially with BILOU tag.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>label</strong> – Label with BILOU component removed.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mika.kd.NER.identify_bad_annotations">
<span class="sig-prename descclassname"><span class="pre">mika.kd.NER.</span></span><span class="sig-name descname"><span class="pre">identify_bad_annotations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text_df</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.NER.identify_bad_annotations" title="Permalink to this definition"></a></dt>
<dd><p>Used for identifying invalid annotations which typically occur from inaccurate tagging,
for example, tagging an extra space or punctuation. Must be ran prior to any model training
or training will fail on bad annotations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>text_df</strong> (<em>pandas DataFrame</em>) – Dataframe storing the documents. Must contain ‘docs’ column and a ‘tags’ column.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>bad_tokens</strong> – list of tokens that are invalid.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mika.kd.NER.plot_eval_metrics">
<span class="sig-prename descclassname"><span class="pre">mika.kd.NER.</span></span><span class="sig-name descname"><span class="pre">plot_eval_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eval_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savepath</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.NER.plot_eval_metrics" title="Permalink to this definition"></a></dt>
<dd><p>Plots classification metrics on the evaluation set over training.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eval_df</strong> (<em>pandas DataFrame</em>) – Dataframe of evaluation metrics</p></li>
<li><p><strong>save</strong> (<em>Boolean, optional</em>) – True to save the figure as pdf, false to not save. The default is False.</p></li>
<li><p><strong>savepath</strong> (<em>string, optional</em>) – Path to save the figure to. The default is “”.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mika.kd.NER.plot_eval_results">
<span class="sig-prename descclassname"><span class="pre">mika.kd.NER.</span></span><span class="sig-name descname"><span class="pre">plot_eval_results</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">final_train_metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">final_eval_metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savepath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.NER.plot_eval_results" title="Permalink to this definition"></a></dt>
<dd><p>Plots evaluation and training metrics as specified using other functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filepath</strong> (<em>string</em>) – Path to the checkpoint logs.</p></li>
<li><p><strong>final_train_metrics</strong> (<em>Dict, optional</em>) – Dictionary of final training metrics in case they are not recorded in the log. The default is {}.</p></li>
<li><p><strong>final_eval_metrics</strong> (<em>Dict, optional</em>) – Dictionary of final eval metrics in case they are not recorded in the log. The default is {}.</p></li>
<li><p><strong>save</strong> (<em>Boolean, optional</em>) – True to save the figure as pdf, false to not save. The default is False.</p></li>
<li><p><strong>savepath</strong> (<em>string, optional</em>) – Path to save the figure to. The default is “”.</p></li>
<li><p><strong>loss</strong> (<em>Boolean, optional</em>) – True to plot loss False to not plot loss. The default is True.</p></li>
<li><p><strong>metrics</strong> (<em>Boolean, optional</em>) – True to plot evaluation metrics. The default is True.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mika.kd.NER.plot_loss">
<span class="sig-prename descclassname"><span class="pre">mika.kd.NER.</span></span><span class="sig-name descname"><span class="pre">plot_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eval_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savepath</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.NER.plot_loss" title="Permalink to this definition"></a></dt>
<dd><p>Plots the validation and training loss over training.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eval_df</strong> (<em>pandas DataFrame</em>) – Dataframe of evaluation metrics</p></li>
<li><p><strong>training_df</strong> (<em>pandas DataFrame</em>) – Dataframe of training metrics</p></li>
<li><p><strong>save</strong> (<em>Boolean, optional</em>) – True to save the figure as pdf, false to not save. The default is False.</p></li>
<li><p><strong>savepath</strong> (<em>string, optional</em>) – Path to save the figure to. The default is “”.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mika.kd.NER.read_doccano_annots">
<span class="sig-prename descclassname"><span class="pre">mika.kd.NER.</span></span><span class="sig-name descname"><span class="pre">read_doccano_annots</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.NER.read_doccano_annots" title="Permalink to this definition"></a></dt>
<dd><p>Reads in a .jsonl file containing annotations from doccano.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file</strong> (<em>string</em>) – File location.</p></li>
<li><p><strong>encoding</strong> (<em>boolean, optional</em>) – True if the file should be opened with utf-8 encoding. The default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>df</strong> – Dataframe of the annotated document set.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas dataframe</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mika.kd.NER.read_trainer_logs">
<span class="sig-prename descclassname"><span class="pre">mika.kd.NER.</span></span><span class="sig-name descname"><span class="pre">read_trainer_logs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">final_train_metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">final_eval_metrics</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.NER.read_trainer_logs" title="Permalink to this definition"></a></dt>
<dd><p>Reads training logs stored at a checkpoint to get training metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filepath</strong> (<em>string</em>) – Path to the checkpoint logs.</p></li>
<li><p><strong>final_train_metrics</strong> (<em>Dict</em>) – Dictionary of final training metrics in case they are not recorded in the log</p></li>
<li><p><strong>final_eval_metrics</strong> (<em>Dict</em>) – Dictionary of final eval metrics in case they are not recorded in the log</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>eval_df</strong> (<em>pandas DataFrame</em>) – Dataframe of evaluation metrics</p></li>
<li><p><strong>training_df</strong> (<em>pandas DataFrame</em>) – Dataframe of training metrics</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mika.kd.NER.split_docs_to_sentences">
<span class="sig-prename descclassname"><span class="pre">mika.kd.NER.</span></span><span class="sig-name descname"><span class="pre">split_docs_to_sentences</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Tracking</span> <span class="pre">#'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.NER.split_docs_to_sentences" title="Permalink to this definition"></a></dt>
<dd><p>Splits a dataframe of documents into a new dataframe where each sentence from
each document is in its own row. This is useful for using BERT models with
maximum character limits.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>text_df</strong> (<em>pandas DataFrame</em>) – Dataframe storing the documents. Must contain ‘docs’ column and an id column.</p></li>
<li><p><strong>id_col</strong> (<em>string, optional</em>) – The column in the dataframe storing the doucment ids. The default is ‘Tracking #’.</p></li>
<li><p><strong>tags</strong> (<em>boolean, optional</em>) – True if the dataframe also contains tags or annotations. False if no annotations
are present. The default is True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>sentence_df</strong> – New dataframe where each row is a sentence.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mika.kd.NER.tokenize">
<span class="sig-prename descclassname"><span class="pre">mika.kd.NER.</span></span><span class="sig-name descname"><span class="pre">tokenize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sentence_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenizer</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.NER.tokenize" title="Permalink to this definition"></a></dt>
<dd><p>Tokenizer used during dataset creation when the input data has already been tokenized.
Currently unused, can be used to get token ids.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sentence_df</strong> (<em>pandas DataFrame</em>) – Dataframe where each row is a sentence. Has columns ‘sentence’ and ‘tags’</p></li>
<li><p><strong>tokenizer</strong> (<em>tokenizer object</em>) – tokenizer object, usually an autotokenizer Transformers BERT model</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>tokenized_inputs</strong> – list of tokens with corresponding IDs from the tokenizer</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mika.kd.NER.tokenize_and_align_labels">
<span class="sig-prename descclassname"><span class="pre">mika.kd.NER.</span></span><span class="sig-name descname"><span class="pre">tokenize_and_align_labels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sentence_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">align_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.NER.tokenize_and_align_labels" title="Permalink to this definition"></a></dt>
<dd><p>Tokenizes text and aligns with labels. Necessary due to subword tokenization with BERT.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sentence_df</strong> (<em>pandas DataFrame</em>) – Dataframe where each row is a sentence. Has columns ‘sentence’ and ‘tags’</p></li>
<li><p><strong>tokenizer</strong> (<em>tokenizer object</em>) – tokenizer object, usually an autotokenizer Transformers BERT model</p></li>
<li><p><strong>align_labels</strong> (<em>Boolean, optional</em>) – True if labels should be aligned. The default is True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>tokenized_inputs</strong> – Tokenized inputw with new labels alligned to corresponding tokens</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Object</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-mika.kd.trend_analysis">
<span id="mika-kd-trend-analysis"></span><h2>mika.kd.trend_analysis<a class="headerlink" href="#module-mika.kd.trend_analysis" title="Permalink to this heading"></a></h2>
<p>Description: Trend analysis functions.</p>
<dl class="py function">
<dt class="sig sig-object py" id="mika.kd.trend_analysis.add_hazards_to_docs">
<span class="sig-prename descclassname"><span class="pre">mika.kd.trend_analysis.</span></span><span class="sig-name descname"><span class="pre">add_hazards_to_docs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">preprocessed_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id_field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">docs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.trend_analysis.add_hazards_to_docs" title="Permalink to this definition"></a></dt>
<dd><p>Add hazards to documents</p>
<p>Add hazard values to preprocessed_df for running chi-squared tests</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>preprocessed_df</strong> (<em>pandas DataFrame</em>) – pandas datframe containing documents.</p></li>
<li><p><strong>id_field</strong> (<em>string</em>) – the column in preprocessed df that contains document ids</p></li>
<li><p><strong>docs</strong> (<em>Dict</em>) – nested dictionary used to store documents per hazard. Keys are hazards
and value is an inner dict. Inner dict has keys as time variables (e.g., years) and
values are lists.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>preprocessed_df</strong> – pandas datframe containing documents.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mika.kd.trend_analysis.bootstrap_metric">
<span class="sig-prename descclassname"><span class="pre">mika.kd.trend_analysis.</span></span><span class="sig-name descname"><span class="pre">bootstrap_metric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metric_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_vals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_percentages</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_means</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">CI_interval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">95</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.trend_analysis.bootstrap_metric" title="Permalink to this definition"></a></dt>
<dd><p>Bootstrap metric</p>
<p>Performs bootstrapping to better estimate the true metric value given a metric percentage (i.e., hazard extraction accuracy).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metric_data</strong> (<em>dict</em>) – nested dict where keys are hazards. inner dict has time value (usually years) as keys
and list of metrics for values.</p></li>
<li><p><strong>time_vals</strong> (<em>list</em>) – list of time values in the time series. generated in plot metric time series.</p></li>
<li><p><strong>metric_percentages</strong> (<em>dictionary</em>) – dict with hazards as keys and values as the percentage to be sampled for each bootstrap.
this can be input as the hazard extraction accuracy to try to better capture the true populate mean.</p></li>
<li><p><strong>num_means</strong> (<em>int, optional</em>) – the number of means calculated via bootstrapping, by default 1000</p></li>
<li><p><strong>CI_interval</strong> (<em>int, optional</em>) – level of confidence for the interval, by default 95</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>averages</strong> (<em>dictionary</em>) – dictionary with hazards as keys and the value is a list of metric averages with one average per year in the time series.</p></li>
<li><p><strong>CI</strong> (<em>dictionary</em>) – dictionary with hazards as keys and value is a (2,n) array where n is the number of years of data.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mika.kd.trend_analysis.build_word_clouds">
<span class="sig-prename descclassname"><span class="pre">mika.kd.trend_analysis.</span></span><span class="sig-name descname"><span class="pre">build_word_clouds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">word_frequencies</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nrows</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(8,</span> <span class="pre">4)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wordcloud_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.trend_analysis.build_word_clouds" title="Permalink to this definition"></a></dt>
<dd><p>Word clouds</p>
<p>Builds a word cloud for each hazard.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>word_frequencies</strong> (<em>dictionary</em>) – nested dictionary where keys are hazards. inner dictionary has words as keys and word frequencies as values.</p></li>
<li><p><strong>nrows</strong> (<em>int</em>) – number of rows in the grid of word clouds</p></li>
<li><p><strong>ncols</strong> (<em>int</em>) – number of columns in the grid of word clouds</p></li>
<li><p><strong>figsize</strong> (<em>tuple, optional</em>) – figure size in inches. The default is (8, 4).</p></li>
<li><p><strong>cmap</strong> (<em>matplotlib colormap, optional</em>) – colormap object used for coloring the word clouds. The default is None.</p></li>
<li><p><strong>save</strong> (<em>boolean, optional</em>) – true to save figure. The default is False.</p></li>
<li><p><strong>save_path</strong> (<em>string, optional</em>) – path to save figure to. The default is None.</p></li>
<li><p><strong>fontsize</strong> (<em>int, optional</em>) – fontsize for title and minimum fontsize in wordcloud. The default is 10.</p></li>
<li><p><strong>wordcloud_kwargs</strong> (<em>dict, optional</em>) – optional keyword args to pass into the wordcloud object. The default is {}.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mika.kd.trend_analysis.calc_CI">
<span class="sig-prename descclassname"><span class="pre">mika.kd.trend_analysis.</span></span><span class="sig-name descname"><span class="pre">calc_CI</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bootstrapped_means</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">CI_interval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">95</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.trend_analysis.calc_CI" title="Permalink to this definition"></a></dt>
<dd><p>Calculate confidence interval</p>
<p>Calculates a confidence interval from a list of means generated using bootstrapping.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bootstrapped_means</strong> (<em>dictionary</em>) – nested dictionary with hazards as keys, inner dictionary with years as keys and a list of bootstrapped means as the value.</p></li>
<li><p><strong>CI_interval</strong> (<em>int, optional</em>) – level of confidence for the interval, by default 95</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>CI</strong> – dictionary with hazards as keys and value is a (2,n) array where n is the number of years of data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dictionary</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mika.kd.trend_analysis.calc_classification_metrics">
<span class="sig-prename descclassname"><span class="pre">mika.kd.trend_analysis.</span></span><span class="sig-name descname"><span class="pre">calc_classification_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labeled_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">docs_per_hazard</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id_col</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.trend_analysis.calc_classification_metrics" title="Permalink to this definition"></a></dt>
<dd><p>Calculate classification metrics</p>
<p>Calculates classification metrics where the true lables come from a file and
the predicted labels are from the hazard extraction process.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>labeled_file</strong> (<em>string</em>) – location the labeled file is saved at</p></li>
<li><p><strong>docs_per_hazard</strong> (<em>Dict</em>) – nested dictionary used to store documents per hazard. Keys are hazards
and value is an inner dict. Inner dict has keys as time variables (e.g., years) and
values are lists.</p></li>
<li><p><strong>id_col</strong> (<em>string</em>) – column in preprocessed_df containing document ids</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>metrics_df</strong> (<em>pandas DataFrame</em>) – dataframe with recall, precision, f1, accuracy, and support for each hazard</p></li>
<li><p><strong>labeled_docs</strong> (<em>pandas DataFrame</em>) – dataframe of the manually labled docs</p></li>
<li><p><strong>HEAT_labeled_docs</strong> (<em>pandas DataFrame</em>) – dataframe of the HEAT labled docs</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mika.kd.trend_analysis.calc_rate">
<span class="sig-prename descclassname"><span class="pre">mika.kd.trend_analysis.</span></span><span class="sig-name descname"><span class="pre">calc_rate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frequency</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.trend_analysis.calc_rate" title="Permalink to this definition"></a></dt>
<dd><p>Calculate rate of occurrence of hazard</p>
<p>Calculates the average rate of occurrence for a hazard from the frequency per year.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>frequency</strong> (<em>Dict</em>) – Nested dictionary used to store hazard frequencies. Keys are hazards and inner dict keys are years, values are ints.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>rates</strong> – dictionary with hazard name as keys and a rate as a value</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mika.kd.trend_analysis.calc_severity_per_hazard">
<span class="sig-prename descclassname"><span class="pre">mika.kd.trend_analysis.</span></span><span class="sig-name descname"><span class="pre">calc_severity_per_hazard</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">docs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id_field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'average'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.trend_analysis.calc_severity_per_hazard" title="Permalink to this definition"></a></dt>
<dd><p>Calculate severity per hazard</p>
<p>Used to calculate the severity for each hazard occurrence, as well as the average severity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>docs</strong> (<em>Dict</em>) – nested dictionary used to store documents per hazard. Keys are hazards
and value is an inner dict. Inner dict has keys as time variables (e.g., years) and
values are lists.</p></li>
<li><p><strong>df</strong> (<em>pandas DataFrame</em>) – pandas datframe containing documents with severity per document already calculated</p></li>
<li><p><strong>id_field</strong> (<em>string</em>) – the column in df that contains document ids</p></li>
<li><p><strong>metric</strong> (<em>string, optional</em>) – whether to calculate the average or maximum severity, default is ‘average’</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>severities</strong> (<em>Dict</em>) – nested dictionary used to store severities per hazard occurrence. Keys are hazards
and value is an inner dict. Inner dict has keys as time variables (e.g., years) and
values are lists of severities.</p></li>
<li><p><strong>total_severities_hazard</strong> (<em>Dict</em>) – Dictionary used to store average severity per hazard. Keys are hazards
and value is average severity.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mika.kd.trend_analysis.check_for_hazard_words">
<span class="sig-prename descclassname"><span class="pre">mika.kd.trend_analysis.</span></span><span class="sig-name descname"><span class="pre">check_for_hazard_words</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h_word</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.trend_analysis.check_for_hazard_words" title="Permalink to this definition"></a></dt>
<dd><p>Check for hazard words</p>
<p>Checks to see if a section of text contains a hazard word.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>h_word</strong> (<em>string</em>) – hazard word</p></li>
<li><p><strong>text</strong> (<em>string</em>) – section of text being searched for hazard word.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>hazard_found</strong> – true if hazard word appears in text, false if not.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>boolean</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mika.kd.trend_analysis.check_for_negation_words">
<span class="sig-prename descclassname"><span class="pre">mika.kd.trend_analysis.</span></span><span class="sig-name descname"><span class="pre">check_for_negation_words</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">negation_words</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h_word</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.trend_analysis.check_for_negation_words" title="Permalink to this definition"></a></dt>
<dd><p>Check for negation words</p>
<p>Checks to see if any negation words appear within 3 words of a hazard word in a
specified section of text.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>negation_words</strong> (<em>list</em>) – list of negation words.</p></li>
<li><p><strong>text</strong> (<em>string</em>) – section of text being searched for hazard and negation words.</p></li>
<li><p><strong>h_word</strong> (<em>string</em>) – hazard word</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>hazard_found</strong> – true if hazard word appears in text with no negation words, false if not
i.e., a negation word is present.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>boolean</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mika.kd.trend_analysis.chi_squared_tests">
<span class="sig-prename descclassname"><span class="pre">mika.kd.trend_analysis.</span></span><span class="sig-name descname"><span class="pre">chi_squared_tests</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">preprocessed_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hazards</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predictors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pred_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.trend_analysis.chi_squared_tests" title="Permalink to this definition"></a></dt>
<dd><p>Chi squared tests</p>
<p>Performs chi-squared test for each predictor to determine if there is a statistically
significant difference in the counts of the predictor between reports with  and without each hazard</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>preprocessed_df</strong> (<em>pandas DataFrame</em>) – pandas datframe containing documents.</p></li>
<li><p><strong>hazards</strong> (<em>list</em>) – list of hazards</p></li>
<li><p><strong>predictors</strong> (<em>list</em>) – list of columns in the dataframe with categorical predictors of interest.</p></li>
<li><p><strong>pred_dict</strong> (<em>dict, optional</em>) – dictionary with predictors from predicotr list as keys and names to disply in the table as values, default is {}.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>stats_df</strong> (<em>pandas DataFrame</em>) – pandas dataframe containing the chi-squared statistic and p-val for each hazard-predictor pair</p></li>
<li><p><strong>count_dfs</strong> (<em>Dict</em>) – dictionary of pandas dataframes containing the counts for each predictor and hazard</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mika.kd.trend_analysis.corr_sig">
<span class="sig-prename descclassname"><span class="pre">mika.kd.trend_analysis.</span></span><span class="sig-name descname"><span class="pre">corr_sig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.trend_analysis.corr_sig" title="Permalink to this definition"></a></dt>
<dd><p>Correlation signature</p>
<p>Returns the probability matrix for a correlation matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>df</strong> (<em>Pandas Dataframe, optional</em>) – df storing the data that is used to create the correlation matrix.
rows are years, columns are predictors + hazard frequencies, by default None</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>p_matrix</strong> – numpy array with p_values for corresponding dataframe entries</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mika.kd.trend_analysis.create_correlation_matrix">
<span class="sig-prename descclassname"><span class="pre">mika.kd.trend_analysis.</span></span><span class="sig-name descname"><span class="pre">create_correlation_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictors_scaled</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frequencies_scaled</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_vals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(6,</span> <span class="pre">4)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.trend_analysis.create_correlation_matrix" title="Permalink to this definition"></a></dt>
<dd><p>Create correlation matrix</p>
<p>Creates the correlation matrix between all predictors and all hazard frequencies.
All arguments are outputs from create_metrics_time_series.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>predictors_scaled</strong> (<em>dict</em>) – dictionary with keys as predictor names, values as a time series list of values scaled using minmax</p></li>
<li><p><strong>frequencies_scaled</strong> (<em>dict</em>) – dictionary with keys as hazard names, values as times series list of frequencies scaled using minmax</p></li>
<li><p><strong>graph</strong> (<em>boolean, optional</em>) – True to graph the data, false to not graph. The default is True.</p></li>
<li><p><strong>mask_vals</strong> (<em>boolen, optional</em>) – True to mask values that are not significant. The default is False.</p></li>
<li><p><strong>figsize</strong> (<em>tuple, optional</em>) – size of the plot in inches. The default is (6,4).</p></li>
<li><p><strong>fontsize</strong> (<em>int, optional</em>) – fontsize for the plot. The default is 16.</p></li>
<li><p><strong>save</strong> (<em>boolean, optional</em>) – True to save the graph. The default is False.</p></li>
<li><p><strong>results_path</strong> (<em>string, optional</em>) – path to save the plot to. The default is “”.</p></li>
<li><p><strong>title</strong> (<em>Boolean, optional</em>) – True to show a title on graph. The default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>corrMatrix</strong> (<em>pandas DataFrame</em>) – correlation matrix.</p></li>
<li><p><strong>correlation_mat_total</strong> (<em>pandas DataFrame</em>) – stores the hazard and predictor values used for the correlation matrix</p></li>
<li><p><strong>p_values</strong> (<em>pandas DataFrame</em>) – p-vals for each correlation.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mika.kd.trend_analysis.examine_hazard_extraction_mismatches">
<span class="sig-prename descclassname"><span class="pre">mika.kd.trend_analysis.</span></span><span class="sig-name descname"><span class="pre">examine_hazard_extraction_mismatches</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">preprocessed_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hazards</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hazard_words_per_doc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">topics_per_doc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hazard_topics_per_doc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.trend_analysis.examine_hazard_extraction_mismatches" title="Permalink to this definition"></a></dt>
<dd><p>Examine hazard extraction mismatches</p>
<p>Used to examine which documents are mislabled by HEAT. used iteratively to refine hazard extraction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>preprocessed_df</strong> (<em>TYPE</em>) – DESCRIPTION.</p></li>
<li><p><strong>true</strong> (<em>pandas DataFrame</em>) – dataframe of the manually labled docs</p></li>
<li><p><strong>pred</strong> (<em>pandas DataFrame</em>) – dataframe of the HEAT labled docs</p></li>
<li><p><strong>hazards</strong> (<em>list</em>) – list of hazards</p></li>
<li><p><strong>hazard_words_per_doc</strong> (<em>Dict</em>) – used to store the hazard words per document. keys are hazards and values are lists
with an element for each document.</p></li>
<li><p><strong>topics_per_doc</strong> (<em>dict</em>) – dictionary with keys as document ids and values as a list of topic numbers</p></li>
<li><p><strong>hazard_topics_per_doc</strong> (<em>dict</em>) – nested dictionary with keys as document ids. inner dictionary has hazard names as keys
and values as a list of topics</p></li>
<li><p><strong>id_col</strong> (<em>string</em>) – column in preprocessed_df containing document ids</p></li>
<li><p><strong>text_col</strong> (<em>string</em>) – column in preprocessed_df containing text</p></li>
<li><p><strong>results_path</strong> (<em>string</em>) – location to save the resulting datasheets to</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>dfs</strong> – dictionary with keys as hazards and values as pandas dataframes storing document mismatches</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mika.kd.trend_analysis.get_doc_text">
<span class="sig-prename descclassname"><span class="pre">mika.kd.trend_analysis.</span></span><span class="sig-name descname"><span class="pre">get_doc_text</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temp_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id_field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text_field</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.trend_analysis.get_doc_text" title="Permalink to this definition"></a></dt>
<dd><p>Get document text</p>
<p>Gets the text for a document.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>id_</strong> (<em>string</em>) – id of the specified document</p></li>
<li><p><strong>temp_df</strong> (<em>pandas DataFrame</em>) – subset of preprocessed_df only containing documents associated with the specified hazard</p></li>
<li><p><strong>id_field</strong> (<em>string</em>) – the column in preprocessed df that contains document ids</p></li>
<li><p><strong>text_field</strong> (<em>string</em>) – the column in preprocessed df that stores the text. can be different from results_text_field,
but is usually the same</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>text</strong> – the document text</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mika.kd.trend_analysis.get_doc_time">
<span class="sig-prename descclassname"><span class="pre">mika.kd.trend_analysis.</span></span><span class="sig-name descname"><span class="pre">get_doc_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temp_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id_field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_field</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.trend_analysis.get_doc_time" title="Permalink to this definition"></a></dt>
<dd><p>Get document time</p>
<p>Gets the time value for a document. usually the year of the report, but could
also be month or any other time value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>id_</strong> (<em>string</em>) – id of the specified document</p></li>
<li><p><strong>temp_df</strong> (<em>pandas DataFrame</em>) – subset of preprocessed_df only containing documents associated with the specified hazard</p></li>
<li><p><strong>id_field</strong> (<em>string</em>) – the column in preprocessed df that contains document ids</p></li>
<li><p><strong>time_field</strong> (<em>string</em>) – the column in preprocessed df that contains document time values, such as report year</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>year</strong> – the time value for the specified document, usually a year</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mika.kd.trend_analysis.get_hazard_df">
<span class="sig-prename descclassname"><span class="pre">mika.kd.trend_analysis.</span></span><span class="sig-name descname"><span class="pre">get_hazard_df</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hazard_info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hazards</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.trend_analysis.get_hazard_df" title="Permalink to this definition"></a></dt>
<dd><p>Get hazard dataframe</p>
<p>Gets hazard information for a specified hazard.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hazard_info</strong> (<em>pandas DataFrame</em>) – pandas dataframe with columns for hazard names, hazard words, and topics per hazard</p></li>
<li><p><strong>hazards</strong> (<em>list</em>) – list of hazard names</p></li>
<li><p><strong>i</strong> (<em>int</em>) – the index of the specified hazard in hazard list.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>hazard_df</strong> (<em>pandas DataFrame</em>) – dataframe containing the information (topics, words, etc) for the specified hazard</p></li>
<li><p><strong>hazard_name</strong> (<em>string</em>) – name of the specified hazard</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mika.kd.trend_analysis.get_hazard_doc_ids">
<span class="sig-prename descclassname"><span class="pre">mika.kd.trend_analysis.</span></span><span class="sig-name descname"><span class="pre">get_hazard_doc_ids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nums</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results_text_field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">docs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doc_topic_distribution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text_field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">topic_thresh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preprocessed_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id_field</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.trend_analysis.get_hazard_doc_ids" title="Permalink to this definition"></a></dt>
<dd><p>Get hazard document IDs</p>
<p>Gets the document ids associated with a specified hazard.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nums</strong> (<em>list</em>) – list of topic numbers associated with the hazard</p></li>
<li><p><strong>results</strong> (<em>pandas DataFrame</em>) – dataframe with topic modeling results generated using topic model plus</p></li>
<li><p><strong>results_text_field</strong> (<em>string</em>) – column in result dataframe where topic numbers are stored for the specified text column</p></li>
<li><p><strong>docs</strong> (<em>list</em>) – list of document ids.</p></li>
<li><p><strong>doc_topic_distribution</strong> (<em>pandas DataFrame</em>) – dataframe containing topic distributions per document</p></li>
<li><p><strong>text_field</strong> (<em>string</em>) – the column in preprocessed df that stores the text. can be different from results_text_field,
but is usually the same</p></li>
<li><p><strong>topic_thresh</strong> (<em>float</em>) – the probability threshold a document must have to be considered in a topic</p></li>
<li><p><strong>preprocessed_df</strong> (<em>pandas DataFrame</em>) – pandas datframe containing documents</p></li>
<li><p><strong>id_field</strong> (<em>string</em>) – the column in preprocessed df that contains document ids</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>temp_df</strong> (<em>pandas DataFrame</em>) – subset of preprocessed_df only containing documents associated with the specified hazard</p></li>
<li><p><strong>ids_</strong> (<em>list</em>) – list of document ids associated with the specified hazard</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mika.kd.trend_analysis.get_hazard_info">
<span class="sig-prename descclassname"><span class="pre">mika.kd.trend_analysis.</span></span><span class="sig-name descname"><span class="pre">get_hazard_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hazard_file</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.trend_analysis.get_hazard_info" title="Permalink to this definition"></a></dt>
<dd><p>Get hazard information</p>
<p>Loads hazard information from hazard spreadsheet.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>hazard_file</strong> (<em>string</em>) – filepath to hazard interpretation spreadsheet</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>hazard_info</strong> (<em>pandas DataFrame</em>) – pandas dataframe with columns for hazard names, hazard words, and topics per hazard</p></li>
<li><p><strong>hazards</strong> (<em>list</em>) – list of hazard names</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mika.kd.trend_analysis.get_hazard_topics">
<span class="sig-prename descclassname"><span class="pre">mika.kd.trend_analysis.</span></span><span class="sig-name descname"><span class="pre">get_hazard_topics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hazard_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">begin_nums</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.trend_analysis.get_hazard_topics" title="Permalink to this definition"></a></dt>
<dd><p>Get hazard topics</p>
<p>Gets topic numbers for a hazard from the hazard dataframe.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hazard_df</strong> (<em>pandas DataFrame</em>) – dataframe containing the information (topics, words, etc) for the specified hazard</p></li>
<li><p><strong>begin_nums</strong> (<em>int</em>) – The topic index to begin at. is -1 if using bertopic since the top level ‘topic’ is really
the cluster of documents not belonging to a topic. 0 otherwise.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>nums</strong> – list of topic numbers associated with the hazard</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mika.kd.trend_analysis.get_hazard_topics_per_doc">
<span class="sig-prename descclassname"><span class="pre">mika.kd.trend_analysis.</span></span><span class="sig-name descname"><span class="pre">get_hazard_topics_per_doc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">topics_per_doc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hazard_topics_per_doc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hazard_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nums</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">begin_nums</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.trend_analysis.get_hazard_topics_per_doc" title="Permalink to this definition"></a></dt>
<dd><p>Get hazard topics per document</p>
<p>Gets the topics per document that are associated with a specied hazard.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ids</strong> (<em>list</em>) – list of document ids associated with the specified hazard</p></li>
<li><p><strong>topics_per_doc</strong> (<em>dict</em>) – dictionary with keys as document ids and values as a list of topic numbers</p></li>
<li><p><strong>hazard_topics_per_doc</strong> (<em>dict</em>) – nested dictionary with keys as document ids. inner dictionary has hazard names as keys
and values as a list of topic. inner dictionary values are all empty lists for input variable.</p></li>
<li><p><strong>hazard_name</strong> (<em>string</em>) – name of specified hazard</p></li>
<li><p><strong>nums</strong> (<em>list</em>) – list of topic numbers associated with the hazard</p></li>
<li><p><strong>begin_nums</strong> (<em>int</em>) – The topic index to begin at. is -1 if using bertopic since the top level ‘topic’ is really
the cluster of documents not belonging to a topic. 0 otherwise.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>hazard_topics_per_doc</strong> – nested dictionary with keys as document ids. inner dictionary has hazard names as keys
and values as a list of topics</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mika.kd.trend_analysis.get_hazard_words">
<span class="sig-prename descclassname"><span class="pre">mika.kd.trend_analysis.</span></span><span class="sig-name descname"><span class="pre">get_hazard_words</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hazard_df</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.trend_analysis.get_hazard_words" title="Permalink to this definition"></a></dt>
<dd><p>Get hazard words</p>
<p>Gets the hazard words for a specified hazard dataframe.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>hazard_df</strong> (<em>pandas DataFrame</em>) – dataframe containing the information (topics, words, etc) for the specified hazard</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>hazard_words</strong> – list of hazard words</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mika.kd.trend_analysis.get_likelihood_FAA">
<span class="sig-prename descclassname"><span class="pre">mika.kd.trend_analysis.</span></span><span class="sig-name descname"><span class="pre">get_likelihood_FAA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rates</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.trend_analysis.get_likelihood_FAA" title="Permalink to this definition"></a></dt>
<dd><p>FAA likelihood</p>
<p>Converts hazard rate of occurrence to an FAA likelihood category.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>rates</strong> (<em>dict</em>) – dictionary with hazard name as keys and a rate as a value</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>curr_likelihoods</strong> – dictionary with hazard name as keys and a likelihood category as a value</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mika.kd.trend_analysis.get_likelihood_USFS">
<span class="sig-prename descclassname"><span class="pre">mika.kd.trend_analysis.</span></span><span class="sig-name descname"><span class="pre">get_likelihood_USFS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rates</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.trend_analysis.get_likelihood_USFS" title="Permalink to this definition"></a></dt>
<dd><p>USFS likelihood</p>
<p>Converts hazard rate of occurrence to an USFS likelihood category.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>rates</strong> (<em>dict</em>) – dictionary with hazard name as keys and a rate as a value</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>curr_likelihoods</strong> – dictionary with hazard name as keys and a likelihood category as a value</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mika.kd.trend_analysis.get_negation_words">
<span class="sig-prename descclassname"><span class="pre">mika.kd.trend_analysis.</span></span><span class="sig-name descname"><span class="pre">get_negation_words</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hazard_df</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.trend_analysis.get_negation_words" title="Permalink to this definition"></a></dt>
<dd><p>Get negation words</p>
<p>Gets the negation words for a specified hazard dataframe</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>hazard_df</strong> (<em>pandas DataFrame</em>) – dataframe containing the information (topics, words, etc) for the specified hazard</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>negation_words</strong> – list of negation words</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mika.kd.trend_analysis.get_results_info">
<span class="sig-prename descclassname"><span class="pre">mika.kd.trend_analysis.</span></span><span class="sig-name descname"><span class="pre">get_results_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">results_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results_text_field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text_field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doc_topic_dist_field</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.trend_analysis.get_results_info" title="Permalink to this definition"></a></dt>
<dd><p>Get results information</p>
<p>Pulls topic modeling results from results spreadsheet generated with topic model plus.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>results_file</strong> (<em>string</em>) – filepath to results spreadsheet</p></li>
<li><p><strong>results_text_field</strong> (<em>string</em>) – column in result dataframe where topic numbers are stored for the specified text column</p></li>
<li><p><strong>text_field</strong> (<em>string</em>) – the text field of interest in the preprocessed_df. sometimes it is different from results_text_field but it is usually the same.</p></li>
<li><p><strong>doc_topic_dist_field</strong> (<em>string or None</em>) – the column storing the topic distribution per document information.
Can be ommitted, only used when a user wants to filter results so a document
only belings to a topic if the probability is above a specified threshold.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>results</strong> (<em>pandas DataFrame</em>) – dataframe with topic modeling results generated using topic model plus</p></li>
<li><p><strong>results_text_field</strong> (<em>string</em>) – column in result dataframe where topic numbers are stored for the specified text column</p></li>
<li><p><strong>doc_topic_distribution</strong> (<em>pandas DataFrame</em>) – dataframe containing topic distributions per document</p></li>
<li><p><strong>begin_nums</strong> (<em>int</em>) – The topic index to begin at. is -1 if using bertopic since the top level ‘topic’ is really
the cluster of documents not belonging to a topic. 0 otherwise.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mika.kd.trend_analysis.get_topics_per_doc">
<span class="sig-prename descclassname"><span class="pre">mika.kd.trend_analysis.</span></span><span class="sig-name descname"><span class="pre">get_topics_per_doc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">docs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results_text_field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hazards</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.trend_analysis.get_topics_per_doc" title="Permalink to this definition"></a></dt>
<dd><p>Get topics per document</p>
<p>Finds the topics associated with each document.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>docs</strong> (<em>list</em>) – list of document ids.</p></li>
<li><p><strong>results</strong> (<em>pandas DataFrame</em>) – dataframe with topic modeling results generated using topic model plus</p></li>
<li><p><strong>results_text_field</strong> (<em>string</em>) – column in result dataframe where topic numbers are stored for the specified text column</p></li>
<li><p><strong>hazards</strong> (<em>list</em>) – list of hazards</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>topics_per_doc</strong> (<em>dict</em>) – dictionary with keys as document ids and values as a list of topic numbers</p></li>
<li><p><strong>hazard_topics_per_doc</strong> (<em>dict</em>) – nested dictionary with keys as document ids. inner dictionary has hazard names as keys
and values as a list of topics</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mika.kd.trend_analysis.get_word_frequencies">
<span class="sig-prename descclassname"><span class="pre">mika.kd.trend_analysis.</span></span><span class="sig-name descname"><span class="pre">get_word_frequencies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hazard_words_per_doc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hazards_sorted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.trend_analysis.get_word_frequencies" title="Permalink to this definition"></a></dt>
<dd><p>Word frequencies</p>
<p>Calculate word frequencies.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hazard_words_per_doc</strong> (<em>Dict</em>) – used to store the hazard words per document. keys are hazards and values are lists
with an element for each document.</p></li>
<li><p><strong>hazards_sorted</strong> (<em>list, optional</em>) – ordered list of hazards for generating frequencies. The default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>word_frequencies</strong> – nested dictionary where keys are hazards. inner dictionary has words as keys and word frequencies as values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dictionary</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mika.kd.trend_analysis.hazard_accuracy">
<span class="sig-prename descclassname"><span class="pre">mika.kd.trend_analysis.</span></span><span class="sig-name descname"><span class="pre">hazard_accuracy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">docs_per_hazard</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hazard_words_per_doc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preprocessed_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.trend_analysis.hazard_accuracy" title="Permalink to this definition"></a></dt>
<dd><p>Hazard accuracy</p>
<p>Creates a data sheet to calculate hazard extraction acccuracy by randomly sampling documents for each hazard.
This method actually is calculating precision at k, k=num.
Note that this method is not the prefered method to evaluate hazard accuracy,
Instead a user should use the classification metrics and label a validation set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>docs_per_hazard</strong> (<em>Dict</em>) – nested dictionary used to store documents per hazard. Keys are hazards
and value is an inner dict. Inner dict has keys as time variables (e.g., years) and
values are lists.</p></li>
<li><p><strong>num</strong> (<em>int</em>) – number of documents to sample for each hazard.</p></li>
<li><p><strong>results_path</strong> (<em>string</em>) – filepath to topic modelresults spreadsheet</p></li>
<li><p><strong>hazard_words_per_doc</strong> (<em>Dict</em>) – used to store the hazard words per document. keys are hazards and values are lists
with an element for each document.</p></li>
<li><p><strong>preprocessed_df</strong> (<em>pandas DataFrame</em>) – pandas datframe containing documents</p></li>
<li><p><strong>text_col</strong> (<em>string</em>) – column in preprocessed_df containing text</p></li>
<li><p><strong>id_col</strong> (<em>string</em>) – column in preprocessed_df containing document ids</p></li>
<li><p><strong>seed</strong> (<em>int, optional</em>) – seed for random sampling. The default is 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>sampled_hazard_ids</strong> (<em>dict</em>) – dictionary with hazards as keys and a list of document ids for values</p></li>
<li><p><strong>total_ids</strong> (<em>list</em>) – list of all the ids of documents belonging to any hazard</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mika.kd.trend_analysis.identify_docs_per_fmea_row">
<span class="sig-prename descclassname"><span class="pre">mika.kd.trend_analysis.</span></span><span class="sig-name descname"><span class="pre">identify_docs_per_fmea_row</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grouping_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id_col</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.trend_analysis.identify_docs_per_fmea_row" title="Permalink to this definition"></a></dt>
<dd><p>Identify documents per FMEA row</p>
<p>Identifies the documents corresponding to each row in an FMEA.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas DataFrame</em>) – pandas datframe containing documents.</p></li>
<li><p><strong>grouping_col</strong> (<em>string</em>) – the column in df that is used to group documents into FMEA rows</p></li>
<li><p><strong>year_col</strong> (<em>string</em>) – the column in df that contains document time values, such as report year</p></li>
<li><p><strong>id_col</strong> (<em>string</em>) – the column in df that contains document ids</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>frequency</strong> (<em>Dict</em>) – Nested dictionary used to store hazard frequencies. Keys are hazards and inner dict keys are years, values are ints.</p></li>
<li><p><strong>docs_per_row</strong> (<em>Dict</em>) – nested dictionary used to store documents per hazard. Keys are hazards
and value is an inner dict. Inner dict has keys as time variables (e.g., years) and
values are lists.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mika.kd.trend_analysis.identify_docs_per_hazard">
<span class="sig-prename descclassname"><span class="pre">mika.kd.trend_analysis.</span></span><span class="sig-name descname"><span class="pre">identify_docs_per_hazard</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hazard_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preprocessed_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text_field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id_field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results_text_field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doc_topic_dist_field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">topic_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.trend_analysis.identify_docs_per_hazard" title="Permalink to this definition"></a></dt>
<dd><p>Identify documents per hazard</p>
<p>Outputs the documents per hazard.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hazard_file</strong> (<em>string</em>) – filepath to hazard interpretation spreadsheet</p></li>
<li><p><strong>preprocessed_df</strong> (<em>pandas DataFrame</em>) – pandas datframe containing documents.</p></li>
<li><p><strong>results_file</strong> (<em>string</em>) – filepath to results spreadsheet</p></li>
<li><p><strong>text_field</strong> (<em>string</em>) – the text field of interest in the preprocessed_df. sometimes it is different from results_text_field but it is usually the same.</p></li>
<li><p><strong>time_field</strong> (<em>string</em>) – the column in preprocessed df that contains document time values, such as report year</p></li>
<li><p><strong>id_field</strong> (<em>string</em>) – the column in preprocessed df that contains document ids</p></li>
<li><p><strong>results_text_field</strong> (<em>string, optional</em>) – column in result dataframe where topic numbers are stored for the specified text column
The default is None.</p></li>
<li><p><strong>doc_topic_dist_field</strong> (<em>string or None, optional</em>) – the column storing the topic distribution per document information.
Can be ommitted, only used when a user wants to filter results so a document
only belings to a topic if the probability is above a specified threshold. The default is None.</p></li>
<li><p><strong>topic_thresh</strong> (<em>float, optional</em>) – the probability threshold a document must have to be considered in a topic. The default is 0.0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>frequency</strong> (<em>Dict</em>) – Nested dictionary used to store hazard frequencies. Keys are hazards and inner dict keys are years, values are ints.</p></li>
<li><p><strong>docs_per_hazard</strong> (<em>Dict</em>) – nested dictionary used to store documents per hazard. Keys are hazards
and value is an inner dict. Inner dict has keys as time variables (e.g., years) and
values are lists.</p></li>
<li><p><strong>hazard_words_per_doc</strong> (<em>Dict</em>) – used to store the hazard words per document. keys are hazards and values are lists
with an element for each document.</p></li>
<li><p><strong>topics_per_doc</strong> (<em>dict</em>) – dictionary with keys as document ids and values as a list of topic numbers</p></li>
<li><p><strong>hazard_topics_per_doc</strong> (<em>dict</em>) – nested dictionary with keys as document ids. inner dictionary has hazard names as keys
and values as a list of topics</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mika.kd.trend_analysis.make_pie_chart">
<span class="sig-prename descclassname"><span class="pre">mika.kd.trend_analysis.</span></span><span class="sig-name descname"><span class="pre">make_pie_chart</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">docs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predictor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hazards</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id_field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predictor_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pie_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(17,</span> <span class="pre">9)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.trend_analysis.make_pie_chart" title="Permalink to this definition"></a></dt>
<dd><p>Make pie chart</p>
<p>Makes a set of pie charts, with one pie chart per hazard showing the distribution of the categorical predictor variable specified.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>docs</strong> (<em>Dict</em>) – nested dictionary used to store documents per hazard. Keys are hazards
and value is an inner dict. Inner dict has keys as time variables (e.g., years) and
values are lists.</p></li>
<li><p><strong>data</strong> (<em>pandas DataFrame</em>) – pandas datframe containing documents.</p></li>
<li><p><strong>predictor</strong> (<em>string</em>) – column in the data that has the categorical predictor of interest</p></li>
<li><p><strong>hazards</strong> (<em>list</em>) – list of hazards</p></li>
<li><p><strong>id_field</strong> (<em>string</em>) – the column in preprocessed df that contains document ids</p></li>
<li><p><strong>predictor_label</strong> (<em>string, optional</em>) – predictor label to be shown in the figure title, by default None</p></li>
<li><p><strong>save</strong> (<em>bool, optional</em>) – True to save the figure, by default True</p></li>
<li><p><strong>results_path</strong> (<em>string, optional</em>) – path to save figure to. The default is “”.</p></li>
<li><p><strong>pie_kwargs</strong> (<em>Dict, optional</em>) – Dictionary to pass kwargs into the piechart, default an empty dictionary</p></li>
<li><p><strong>fontsize</strong> (<em>int, optional</em>) – fontsize for the plot. The default is 16.</p></li>
<li><p><strong>figsize</strong> (<em>tuple, optional</em>) – size of the figure in inches. The default is (17, 9)</p></li>
<li><p><strong>padding</strong> (<em>int, optional</em>) – the padding between graphs. The deafult is 5</p></li>
<li><p><strong>legend_kwargs</strong> (<em>dict, optional</em>) – dictionary to pass in legend options</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mika.kd.trend_analysis.minmax_scale">
<span class="sig-prename descclassname"><span class="pre">mika.kd.trend_analysis.</span></span><span class="sig-name descname"><span class="pre">minmax_scale</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_list</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.trend_analysis.minmax_scale" title="Permalink to this definition"></a></dt>
<dd><p>Minmax scale</p>
<p>Performs minmax scaling on a single data list in order to normalize the data.
normalization is required prior to regression and ML.
Also it is used for graphing multiple time series on the same axes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data_list</strong> (<em>list</em>) – list of numerical data that will be scaled using minmax scaling</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>scaled_list</strong> – list of data scaled between 0-1</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mika.kd.trend_analysis.multiple_reg_feature_importance">
<span class="sig-prename descclassname"><span class="pre">mika.kd.trend_analysis.</span></span><span class="sig-name descname"><span class="pre">multiple_reg_feature_importance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hazards</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">correlation_mat_total</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r2_fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r2_figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(3.5,</span> <span class="pre">4)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predictor_import_fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predictor_import_figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">4)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.trend_analysis.multiple_reg_feature_importance" title="Permalink to this definition"></a></dt>
<dd><p>Multiple regression feature importance</p>
<p>Builds multiple regression model for hazrd frequency given the predictors.
Also performs predictor importance to identify which predictors are most relevant to the hazards frequency.
Predictors and hazards must be values from the correlation_mat_total.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>predictors</strong> (<em>list</em>) – list of predictor names, used to identify inputs to multiple regression</p></li>
<li><p><strong>hazards</strong> (<em>list</em>) – list of hazard names, used to identify targets for multiple regression</p></li>
<li><p><strong>correlation_mat_total</strong> (<em>dataframe</em>) – stores the time series values that were used for correlation matrix.
rows are years, columns are predictors + hazard frequencies</p></li>
<li><p><strong>save</strong> (<em>bool, optional</em>) – True to save resulting figure, by default False</p></li>
<li><p><strong>results_path</strong> (<em>str, optional</em>) – _description_, by default “”</p></li>
<li><p><strong>r2_fontsize</strong> (<em>int, optional</em>) – Frontsize for r2 figure, by default 10</p></li>
<li><p><strong>r2_figsize</strong> (<em>tuple, optional</em>) – figsize for r2 figure, by default (3.5,4)</p></li>
<li><p><strong>predictor_import_fontsize</strong> (<em>int, optional</em>) – fontsize for predictor importancce figure, by default 10</p></li>
<li><p><strong>predictor_import_figsize</strong> (<em>tuple, optional</em>) – figsize for predictor importance figure, by default (7,4)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>results_df</strong> (<em>Pandas Dataframe</em>) – dataframe containing both the mse and r2 scores for the model</p></li>
<li><p><strong>delta_df</strong> (<em>Pandas Dataframe</em>) – dataframe containing the difference between the total model and the model when the predictor is shuffled</p></li>
<li><p><strong>coefficient_df</strong> (<em>Pandas Dataframe</em>) – dataframe containing the regression coefficients for predictor importance</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mika.kd.trend_analysis.plot_USFS_risk_matrix">
<span class="sig-prename descclassname"><span class="pre">mika.kd.trend_analysis.</span></span><span class="sig-name descname"><span class="pre">plot_USFS_risk_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">likelihoods</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">severities</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(9,</span> <span class="pre">5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_chars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.trend_analysis.plot_USFS_risk_matrix" title="Permalink to this definition"></a></dt>
<dd><p>Plot USFS risk matrix</p>
<p>Plots a USFS risk matrix from likelihood and severity categories.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>likelihoods</strong> (<em>dict</em>) – dictionary with hazard name as keys and a likelihood category as a value</p></li>
<li><p><strong>severities</strong> (<em>dict</em>) – dictionary with hazard name as keys and a severity category as a value</p></li>
<li><p><strong>figsize</strong> (<em>tuple, optional</em>) – figure size in inches. The default is (9,5).</p></li>
<li><p><strong>save</strong> (<em>boolean, optional</em>) – true to save the figure. The default is False.</p></li>
<li><p><strong>results_path</strong> (<em>string, optional</em>) – path to save figure to. The default is “”.</p></li>
<li><p><strong>fontsize</strong> (<em>int, optional</em>) – figure fontsize. The default is 12.</p></li>
<li><p><strong>max_chars</strong> (<em>int, optional</em>) – maximum characters per line in a cell of the risk matrix.
used to improve readability and ensure hazard names are contained in a cell.
The default is 20.</p></li>
<li><p><strong>title</strong> (<em>boolean, optional</em>) – Dtrue to show title. The default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mika.kd.trend_analysis.plot_frequency_time_series">
<span class="sig-prename descclassname"><span class="pre">mika.kd.trend_analysis.</span></span><span class="sig-name descname"><span class="pre">plot_frequency_time_series</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metric_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Frequency'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">line_styles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">markers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Year'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xtick_freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(6,</span> <span class="pre">4)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interval_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'false_neg_rate':</span> <span class="pre">0.05,</span> <span class="pre">'false_pos_rate':</span> <span class="pre">0.05}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.trend_analysis.plot_frequency_time_series" title="Permalink to this definition"></a></dt>
<dd><p>Plot frequency time series</p>
<p>Plots hazard frequency over time.
Different from plot metric time series because of input data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metric_data</strong> (<em>dict</em>) – nested dict where keys are hazards. inner dict has time value (usually years) as keys
and frequency count as an integer for values.</p></li>
<li><p><strong>metric_name</strong> (<em>string, optional</em>) – name of metric. The default is ‘Frequency’.</p></li>
<li><p><strong>line_styles</strong> (<em>list, optional</em>) – list of line styles to use. should have one value for each hazard. The default is [].</p></li>
<li><p><strong>markers</strong> (<em>list, optional</em>) – list of line markers to use. should have one value for each hazard. The default is [].</p></li>
<li><p><strong>title</strong> (<em>string, optional</em>) – title to add to plot. The default is “”.</p></li>
<li><p><strong>time_name</strong> (<em>string, optional</em>) – name of the time interval used to label the x axis. The default is “Year”.</p></li>
<li><p><strong>xtick_freq</strong> (<em>int, optional</em>) – the number of values per x tick, e.g., the default would go 2015, 2020, 2025. The default is 5.</p></li>
<li><p><strong>scale</strong> (<em>boolean, optional</em>) – true to minmax scale data, false to use raw data. The default is False.</p></li>
<li><p><strong>save</strong> (<em>boolean, optional</em>) – true to save the plot as a pdf. The default is False.</p></li>
<li><p><strong>results_path</strong> (<em>string, optional</em>) – path to save figure to. The default is “”.</p></li>
<li><p><strong>yscale</strong> (<em>string, optional</em>) – yscale parameter, can be used to change scaling to log. The default is None.</p></li>
<li><p><strong>legend</strong> (<em>boolean, optional</em>) – true to show legend, false to hide legend. The default is True.</p></li>
<li><p><strong>figsize</strong> (<em>tuple, optional</em>) – size of the plot in inches. The default is (6,4).</p></li>
<li><p><strong>fontsize</strong> (<em>int, optional</em>) – fontsize for the plot. The default is 16.</p></li>
<li><p><strong>interval</strong> (<em>bool, optional</em>) – true to contstruct an interval for the metric based on false pos/neg rate. The default is False.</p></li>
<li><p><strong>interval_kwargs</strong> (<em>dict, optional</em>) – dictionary to pass in the false positive and false negative rate for each hazard. The default is {‘false_pos_rate’:0.05, ‘false_neg_rate’:0.05}.</p></li>
<li><p><strong>legend_kwargs</strong> (<em>dict, optional</em>) – dictionary to pass in legend options</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mika.kd.trend_analysis.plot_metric_averages">
<span class="sig-prename descclassname"><span class="pre">mika.kd.trend_analysis.</span></span><span class="sig-name descname"><span class="pre">plot_metric_averages</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metric_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_std</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(6,</span> <span class="pre">4)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_bars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'stddev'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.trend_analysis.plot_metric_averages" title="Permalink to this definition"></a></dt>
<dd><p>Plot metric averages</p>
<p>Plots metric averages as a barchart.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metric_data</strong> (<em>dict</em>) – nested dict where keys are hazards. inner dict has time value (usually years) as keys
and list of metrics for values.</p></li>
<li><p><strong>metric_name</strong> (<em>string</em>) – name of metric, e.g., severity, used for axis and saving the figure</p></li>
<li><p><strong>show_std</strong> (<em>boolean, optional</em>) – true to show std deviation on time series as error bars. The default is True.</p></li>
<li><p><strong>title</strong> (<em>string, optional</em>) – title to add to plot. The default is “”.</p></li>
<li><p><strong>save</strong> (<em>boolean, optional</em>) – true to save the plot as a pdf. The default is False.</p></li>
<li><p><strong>results_path</strong> (<em>string, optional</em>) – path to save figure to. The default is “”.</p></li>
<li><p><strong>yscale</strong> (<em>string, optional</em>) – yscale parameter, can be used to change scaling to log. The default is None.</p></li>
<li><p><strong>legend</strong> (<em>boolean, optional</em>) – true to show legend, false to hide legend. The default is True.</p></li>
<li><p><strong>figsize</strong> (<em>tuple, optional</em>) – size of the plot in inches. The default is (6,4).</p></li>
<li><p><strong>fontsize</strong> (<em>int, optional</em>) – fontsize for the plot. The default is 16.</p></li>
<li><p><strong>error_bars</strong> (<em>string</em>) – type of error bars to use, can be ‘stddev’ or ‘CI’. The default is ‘stddev’.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mika.kd.trend_analysis.plot_metric_time_series">
<span class="sig-prename descclassname"><span class="pre">mika.kd.trend_analysis.</span></span><span class="sig-name descname"><span class="pre">plot_metric_time_series</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metric_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">line_styles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">markers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Year'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaled</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xtick_freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_std</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(6,</span> <span class="pre">4)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bootstrap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bootstrap_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'CI_interval':</span> <span class="pre">95,</span> <span class="pre">'metric_percentages':</span> <span class="pre">1,</span> <span class="pre">'num_means':</span> <span class="pre">1000}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.trend_analysis.plot_metric_time_series" title="Permalink to this definition"></a></dt>
<dd><p>Plot metric time series</p>
<p>Plots a time series for specified metrics for all hazards (i.e., line chart).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metric_data</strong> (<em>dict</em>) – nested dict where keys are hazards. inner dict has time value (usually years) as keys
and list of metrics for values.</p></li>
<li><p><strong>metric_name</strong> (<em>string</em>) – name of metric, e.g., severity, used for axis and saving the figure</p></li>
<li><p><strong>line_styles</strong> (<em>list, optional</em>) – list of line styles to use. should have one value for each hazard. The default is [].</p></li>
<li><p><strong>markers</strong> (<em>list, optional</em>) – list of line markers to use. should have one value for each hazard. The default is [].</p></li>
<li><p><strong>title</strong> (<em>string, optional</em>) – title to add to plot. The default is “”.</p></li>
<li><p><strong>time_name</strong> (<em>string, optional</em>) – name of the time interval used to label the x axis. The default is “Year”.</p></li>
<li><p><strong>scaled</strong> (<em>boolean, optional</em>) – true to minmax scale data, false to use raw data. The default is False.</p></li>
<li><p><strong>xtick_freq</strong> (<em>int, optional</em>) – the number of values per x tick, e.g., the default would go 2015, 2020, 2025. The default is 5.</p></li>
<li><p><strong>show_std</strong> (<em>boolean, optional</em>) – true to show std deviation on time series as error bars. The default is True.</p></li>
<li><p><strong>save</strong> (<em>boolean, optional</em>) – true to save the plot as a pdf. The default is False.</p></li>
<li><p><strong>results_path</strong> (<em>string, optional</em>) – path to save figure to. The default is “”.</p></li>
<li><p><strong>yscale</strong> (<em>string, optional</em>) – yscale parameter, can be used to change scaling to log. The default is None.</p></li>
<li><p><strong>legend</strong> (<em>boolean, optional</em>) – true to show legend, false to hide legend. The default is True.</p></li>
<li><p><strong>figsize</strong> (<em>tuple, optional</em>) – size of the plot in inches. The default is (6,4).</p></li>
<li><p><strong>fontsize</strong> (<em>int, optional</em>) – fontsize for the plot. The default is 16.</p></li>
<li><p><strong>bootstrap</strong> (<em>Boolean, optional</em>) – true to bootstrap the data for a confidence interval. The default is False.</p></li>
<li><p><strong>bootstrap_kwargs</strong> (<em>dict, optional</em>) – dictionary to pass bootstrapping parameters</p></li>
<li><p><strong>legend_kwargs</strong> (<em>dict, optional</em>) – dictionary to pass in legend options</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mika.kd.trend_analysis.plot_predictors">
<span class="sig-prename descclassname"><span class="pre">mika.kd.trend_analysis.</span></span><span class="sig-name descname"><span class="pre">plot_predictors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predictor_labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Year'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">totals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">averages</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaled</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(12,</span> <span class="pre">5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.trend_analysis.plot_predictors" title="Permalink to this definition"></a></dt>
<dd><p>Plot predictors</p>
<p>Plots predictor timeseries.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>predictors</strong> (<em>list</em>) – list of predictors</p></li>
<li><p><strong>predictor_labels</strong> (<em>list</em>) – list of labels for the predictors which will be shown on the graph</p></li>
<li><p><strong>time</strong> (<em>list</em>) – list of time values tat define the axis/time series.</p></li>
<li><p><strong>time_label</strong> (<em>string, optional</em>) – label for the time values. The default is ‘Year’.</p></li>
<li><p><strong>title</strong> (<em>string, optional</em>) – figure title. The default is “”.</p></li>
<li><p><strong>totals</strong> (<em>boolean, optional</em>) – true to graph total or sum values. The default is True.</p></li>
<li><p><strong>averages</strong> (<em>boolean, optional</em>) – true to graph average values. The default is True.</p></li>
<li><p><strong>scaled</strong> (<em>boolean, optional</em>) – true to minmax scale the timeseries data. The default is True.</p></li>
<li><p><strong>figsize</strong> (<em>tuple, optional</em>) – figure size in inches. The default is (12, 5).</p></li>
<li><p><strong>axs</strong> (<em>matplotlib axs object, optional</em>) – used to plot multiple graphs on one figure. The default is [].</p></li>
<li><p><strong>fig</strong> (<em>matplotlib fig object, optional</em>) – used to plot multiple graphs on one figure. The default is None.</p></li>
<li><p><strong>show</strong> (<em>boolean, optional</em>) – true to show figure, false to return graph objects. The default is False.</p></li>
<li><p><strong>legend</strong> (<em>boolean, optional</em>) – true to show legend. The default is True.</p></li>
<li><p><strong>legend_kwargs</strong> (<em>dict, optional</em>) – dictionary to pass in legend options</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>fig</strong> (<em>matplotlib fig object</em>) – the figure object</p></li>
<li><p><strong>axs</strong> (<em>matplotlib axs object</em>) – axs object</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mika.kd.trend_analysis.plot_risk_matrix">
<span class="sig-prename descclassname"><span class="pre">mika.kd.trend_analysis.</span></span><span class="sig-name descname"><span class="pre">plot_risk_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">likelihoods</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">severities</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(9,</span> <span class="pre">5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_chars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annot_font</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.trend_analysis.plot_risk_matrix" title="Permalink to this definition"></a></dt>
<dd><p>Plot risk matrix</p>
<p>Plots a FAA risk matrix from likelihood and severity categories.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>likelihoods</strong> (<em>dict</em>) – dictionary with hazard name as keys and a likelihood category as a value</p></li>
<li><p><strong>severities</strong> (<em>dict</em>) – dictionary with hazard name as keys and a severity category as a value</p></li>
<li><p><strong>figsize</strong> (<em>tuple, optional</em>) – figure size in inches. The default is (9,5).</p></li>
<li><p><strong>save</strong> (<em>boolean, optional</em>) – true to save the figure. The default is False.</p></li>
<li><p><strong>results_path</strong> (<em>string, optional</em>) – path to save figure to. The default is “”.</p></li>
<li><p><strong>fontsize</strong> (<em>int, optional</em>) – figure fontsize. The default is 12.</p></li>
<li><p><strong>max_chars</strong> (<em>int, optional</em>) – maximum characters per line in a cell of the risk matrix.
used to improve readability and ensure hazard names are contained in a cell.
The default is 20.</p></li>
<li><p><strong>annot_font</strong> (<em>int, optional</em>) – figure annotation fontsize. The default is 12.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mika.kd.trend_analysis.proposed_topics">
<span class="sig-prename descclassname"><span class="pre">mika.kd.trend_analysis.</span></span><span class="sig-name descname"><span class="pre">proposed_topics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lists</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.trend_analysis.proposed_topics" title="Permalink to this definition"></a></dt>
<dd><p>Proposed topics</p>
<p>Experimental function to identify topics that may be relevent to specified hazards
based on manually labeled data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>lists</strong> (<em>list, optional</em>) – list of lists. inner lists are topic numbers for each document manually labeled
as associated with a hazard. The default is [].</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>proposed_topics</strong> – list of proposed new topics.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mika.kd.trend_analysis.record_hazard_doc_info">
<span class="sig-prename descclassname"><span class="pre">mika.kd.trend_analysis.</span></span><span class="sig-name descname"><span class="pre">record_hazard_doc_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hazard_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">docs_per_hazard</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frequency</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hazard_words_per_doc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">docs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h_word</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.trend_analysis.record_hazard_doc_info" title="Permalink to this definition"></a></dt>
<dd><p>Record hazard document information</p>
<p>Saves the information for a specified document that contains a specified hazard.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hazard_name</strong> (<em>string</em>) – name of specified hazard</p></li>
<li><p><strong>year</strong> (<em>int or str</em>) – year that the report occurs in</p></li>
<li><p><strong>docs_per_hazard</strong> (<em>Dict</em>) – nested dictionary used to store documents per hazard. Keys are hazards
and value is an inner dict. Inner dict has keys as time variables (e.g., years) and
values are lists.</p></li>
<li><p><strong>id_</strong> (<em>string</em>) – id of the specified document</p></li>
<li><p><strong>frequency</strong> (<em>Dict</em>) – Nested dictionary used to store hazard frequencies. Keys are hazards and inner dict keys are years, values are ints.</p></li>
<li><p><strong>hazard_words_per_doc</strong> (<em>Dict</em>) – used to store the hazard words per document. keys are hazards and values are lists
with an element for each document.</p></li>
<li><p><strong>docs</strong> (<em>list</em>) – list of document ids.</p></li>
<li><p><strong>h_word</strong> (<em>string</em>) – hazard word</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>docs_per_hazard</strong> (<em>Dict</em>) – nested dictionary used to store documents per hazard. Keys are hazards
and value is an inner dict. Inner dict has keys as time variables (e.g., years) and
values are lists.</p></li>
<li><p><strong>frequency</strong> (<em>Dict</em>) – Nested dictionary used to store hazard frequencies. Keys are hazards and inner dict keys are years, values are ints.</p></li>
<li><p><strong>hazard_words_per_doc</strong> (<em>Dict</em>) – used to store the hazard words per document. keys are hazards and values are lists
with an element for each document.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mika.kd.trend_analysis.regression_feature_importance">
<span class="sig-prename descclassname"><span class="pre">mika.kd.trend_analysis.</span></span><span class="sig-name descname"><span class="pre">regression_feature_importance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hazards</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">correlation_mat_total</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.trend_analysis.regression_feature_importance" title="Permalink to this definition"></a></dt>
<dd><p>Regression feature importance</p>
<p>Performs feature importance for a set of linear regression analyses.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>predictors</strong> (<em>list</em>) – list of predictor names, used to identify inputs to single linear regression</p></li>
<li><p><strong>hazards</strong> (<em>list</em>) – list of hazard names, used to identify targets for single linear regression</p></li>
<li><p><strong>correlation_mat_total</strong> (<em>dataframe</em>) – stores the time series values that were used for correlation matrix.
rows are years, columns are predictors + hazard frequencies</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>results_df</strong> – dataframe containing both the mse and r2 scores for the model</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas dataframe</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mika.kd.trend_analysis.remove_outliers">
<span class="sig-prename descclassname"><span class="pre">mika.kd.trend_analysis.</span></span><span class="sig-name descname"><span class="pre">remove_outliers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rm_outliers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.trend_analysis.remove_outliers" title="Permalink to this definition"></a></dt>
<dd><p>Remove outliers</p>
<p>Removes outliers from the dataset using inter quartile range.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>list</em>) – list of data points</p></li>
<li><p><strong>threshold</strong> (<em>float, optional</em>) – Threshold for the distance outside of the interquartile range that defines an outlier. The default is 1.5.</p></li>
<li><p><strong>rm_outliers</strong> (<em>Booleam, optional</em>) – True to remove outliers, false to return original data. The default is True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>new_data</strong> – list of the data points with outliers removed</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mika.kd.trend_analysis.reshape_correlation_matrix">
<span class="sig-prename descclassname"><span class="pre">mika.kd.trend_analysis.</span></span><span class="sig-name descname"><span class="pre">reshape_correlation_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">corrMatrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predictors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hazards</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(8,</span> <span class="pre">8.025)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.trend_analysis.reshape_correlation_matrix" title="Permalink to this definition"></a></dt>
<dd><p>Reshape correlation matrix</p>
<p>Reshapes the correlation matrix between all predictors and all hazard frequencies.
Columns are predictors and rows are hazards.
Arguments are outputs from create_correlation_matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>corrMatrix</strong> (<em>pandas DataFrame</em>) – correlation matrix.</p></li>
<li><p><strong>p_values</strong> (<em>pandas DataFrame</em>) – p-vals for each correlation.</p></li>
<li><p><strong>predictors</strong> (<em>list</em>) – list of predictors</p></li>
<li><p><strong>hazards</strong> (<em>list</em>) – list of hazards</p></li>
<li><p><strong>figsize</strong> (<em>tuple, optional</em>) – size of the plot in inches. The default is =(8,8.025).</p></li>
<li><p><strong>fontsize</strong> (<em>int, optional</em>) – fontsize for the plot. The default is 16.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mika.kd.trend_analysis.sample_for_accuracy">
<span class="sig-prename descclassname"><span class="pre">mika.kd.trend_analysis.</span></span><span class="sig-name descname"><span class="pre">sample_for_accuracy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">preprocessed_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hazards</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_sample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.trend_analysis.sample_for_accuracy" title="Permalink to this definition"></a></dt>
<dd><p>Sample for accuracy</p>
<p>Generates a spreadsheet of randomly sampled documents to analyze the quality of hazard extraction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>preprocessed_df</strong> (<em>pandas DataFrame</em>) – pandas datframe containing documents</p></li>
<li><p><strong>id_col</strong> (<em>string</em>) – column in preprocessed_df containing document ids</p></li>
<li><p><strong>text_col</strong> (<em>string</em>) – column in preprocessed_df containing text</p></li>
<li><p><strong>hazards</strong> (<em>list</em>) – list of hazards</p></li>
<li><p><strong>save_path</strong> (<em>string</em>) – location to save the file to</p></li>
<li><p><strong>num_sample</strong> (<em>int, optional</em>) – number of documents to sample. The default is 100.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>sampled_df</strong> – dataframe of sampled documents</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mika.kd.trend_analysis.set_up_docs_per_hazard_vars">
<span class="sig-prename descclassname"><span class="pre">mika.kd.trend_analysis.</span></span><span class="sig-name descname"><span class="pre">set_up_docs_per_hazard_vars</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">preprocessed_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id_field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hazards</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_field</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mika.kd.trend_analysis.set_up_docs_per_hazard_vars" title="Permalink to this definition"></a></dt>
<dd><p>Set up documents per hazard variables</p>
<p>Instantiates variables used to find the documents per hazard.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>preprocessed_df</strong> (<em>pandas DataFrame</em>) – pandas datframe containing documents</p></li>
<li><p><strong>id_field</strong> (<em>string</em>) – the column in preprocessed df that contains document ids</p></li>
<li><p><strong>hazards</strong> (<em>list</em>) – list of hazards</p></li>
<li><p><strong>time_field</strong> (<em>string</em>) – the column in preprocessed df that contains document time values, such as report year</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>docs</strong> (<em>list</em>) – list of document ids.</p></li>
<li><p><strong>frequency</strong> (<em>Dict</em>) – Nested dictionary used to store hazard frequencies. Keys are hazards and inner dict keys are years, values are ints.</p></li>
<li><p><strong>docs_per_hazard</strong> (<em>Dict</em>) – nested dictionary used to store documents per hazard. Keys are hazards
and value is an inner dict. Inner dict has keys as time variables (e.g., years) and
values are lists.</p></li>
<li><p><strong>hazard_words_per_doc</strong> (<em>Dict</em>) – used to store the hazard words per document. keys are hazards and values are lists
with an element for each document.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="utils.html" class="btn btn-neutral float-left" title="utils package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="ir.html" class="btn btn-neutral float-right" title="ir package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Copyright © 2023 United States Government as represented by the Administrator of the National Aeronautics and Space Administration. All Rights Reserved.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>